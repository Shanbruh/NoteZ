<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="NoteZ">
<meta name="theme-color" content="#7c6dfa" id="theme-color-meta">
<link rel="apple-touch-icon" href="/NoteZ/logo1.png">
<link rel="manifest" href="/NoteZ/manifest.json">
<title>NoteZ</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">

<style>
  :root {
    --bg: #0f0f11;
    --bg2: #16161a;
    --bg3: #1e1e24;
    --bg4: #26262e;
    --border: #2e2e38;
    --text: #e8e8f0;
    --text2: #9090a8;
    --text3: #5a5a72;
    --accent: #7c6dfa;
    --accent2: #a594ff;
    --accent-glow: rgba(124,109,250,0.18);
    --danger: #ff5b6b;
    --success: #3ddc97;
    --warn: #f4a24b;
    --sidebar-w: 260px;
    --radius: 10px;
    --font: 'Syne', sans-serif;
    --mono: 'DM Mono', monospace;
    --transition: 0.18s cubic-bezier(.4,0,.2,1);
  }
  [data-theme="light"] {
    --bg: #f5f4f8;
    --bg2: #ffffff;
    --bg3: #eeedf3;
    --bg4: #e4e3ea;
    --border: #d4d3e0;
    --text: #18181f;
    --text2: #55546a;
    --text3: #9998b0;
    --accent: #6b5ce7;
    --accent2: #8878ff;
    --accent-glow: rgba(107,92,231,0.12);
  }
  [data-theme="navy"] {
    --bg: #0a0f1e;
    --bg2: #0e1529;
    --bg3: #131d38;
    --bg4: #1a2648;
    --border: #1f3060;
    --text: #d0dcff;
    --text2: #7a92cc;
    --text3: #3a5090;
    --accent: #4d9fff;
    --accent2: #74b8ff;
    --accent-glow: rgba(77,159,255,0.15);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; overflow: hidden; background: var(--accent); }

  body {
    font-family: var(--font);
    background: var(--bg);
    color: var(--text);
    transition: background var(--transition), color var(--transition);
    position: relative;
    height: 100%;
    /* Safe area for notched phones */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* DUOTONE ICONS */
  .dt-icon { width: 18px; height: 18px; display: block; }
  .dt-bg { fill: var(--text3); opacity: 0.25; }
  .dt-stroke { stroke: var(--text2); }
  .dt-stroke-only { stroke: var(--text2); }
  .sb-nav-btn.active .dt-bg { fill: var(--accent); opacity: 0.3; }
  .sb-nav-btn.active .dt-stroke { stroke: var(--accent2); }
  .sb-nav-btn.active .dt-stroke-only { stroke: var(--accent2); }
  .sb-nav-btn:hover .dt-bg { fill: var(--text2); opacity: 0.2; }
  .sb-nav-btn:hover .dt-stroke { stroke: var(--text); }

  /* LAYOUT */
  #app { display: flex; height: 100vh; position: relative; z-index: 1; }

  /* LOGIN */
  #login-screen {
    position: fixed; inset: 0; z-index: 100;
    background: var(--bg);
    display: flex; align-items: center; justify-content: center;
    flex-direction: column;
  }
  #login-screen .login-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 48px 44px;
    width: 100%; max-width: 400px;
    text-align: center;
    box-shadow: 0 8px 60px rgba(0,0,0,0.35);
  }
  .login-logo {
    font-size: 2.6rem;
    font-weight: 800;
    letter-spacing: -1px;
    margin-bottom: 6px;
  }
  .login-logo span { color: var(--accent); }
  .login-sub { color: var(--text2); font-size: 0.9rem; margin-bottom: 32px; }
  .login-card input {
    width: 100%;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 14px;
    color: var(--text);
    font-family: var(--font);
    font-size: 0.95rem;
    margin-bottom: 12px;
    outline: none;
    transition: border var(--transition), box-shadow var(--transition);
  }
  .login-card input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow); }
  .login-card .btn-primary {
    width: 100%; margin-top: 6px;
    padding: 13px;
    border-radius: 8px;
    font-size: 1rem; font-weight: 700;
  }
  .login-tabs { display: flex; gap: 0; margin-bottom: 28px; border-radius: 8px; overflow: hidden; border: 1px solid var(--border); }
  .login-tab { flex: 1; padding: 10px; cursor: pointer; background: transparent; border: none; color: var(--text2); font-family: var(--font); font-size: 0.9rem; transition: all var(--transition); }
  .login-tab.active { background: var(--accent); color: #fff; font-weight: 600; }
  .login-err { color: var(--danger); font-size: 0.83rem; margin-top: 8px; min-height: 18px; }

  /* SIDEBAR */
  .sidebar {
    width: var(--sidebar-w); min-width: var(--sidebar-w);
    min-width: var(--sidebar-w); min-width: var(--sidebar-w);
    background: var(--bg2);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
    transition: transform var(--transition), width var(--transition), min-width var(--transition);
    position: relative;
    z-index: 10;
  }
  .sidebar.collapsed { transform: translateX(-100%); position: absolute; }

  .sidebar-logo {
    padding: 22px 20px 14px;
    font-size: 1.5rem;
    font-weight: 800;
    letter-spacing: -0.5px;
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 8px;
  }
  .sidebar-logo span.z { color: var(--accent); }
  .sidebar-logo .logo-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); box-shadow: 0 0 8px var(--accent); }

  .sidebar-section { padding: 10px 12px 4px; font-size: 0.7rem; font-weight: 700; letter-spacing: 1.2px; color: var(--text3); text-transform: uppercase; }

  .sidebar-btn {
    display: flex; align-items: center; gap: 9px;
    padding: 8px 14px;
    margin: 1px 8px;
    border-radius: 7px;
    cursor: pointer;
    font-size: 0.88rem;
    font-weight: 500;
    color: var(--text2);
    transition: all var(--transition);
    border: none; background: transparent; width: calc(100% - 16px);
    text-align: left;
  }
  .sidebar-btn:hover, .sidebar-btn.active { background: var(--bg3); color: var(--text); }
  .sidebar-btn .icon { font-size: 1rem; width: 18px; text-align: center; flex-shrink: 0; }

  .sidebar-scroll { flex: 1; overflow-y: auto; padding-bottom: 10px; }
  .sidebar-scroll::-webkit-scrollbar { width: 4px; }
  .sidebar-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  /* Folder tree */
  .folder-item { }
  .folder-header {
    display: flex; align-items: center; gap: 7px;
    padding: 7px 10px 7px 14px;
    margin: 1px 8px;
    border-radius: 7px;
    cursor: pointer;
    font-size: 0.88rem; font-weight: 500;
    color: var(--text2);
    transition: all var(--transition);
    user-select: none;
  }
  .folder-header:hover { background: var(--bg3); color: var(--text); }
  .folder-header.active { background: var(--accent-glow); color: var(--accent2); }
  .folder-arrow { font-size: 0.65rem; transition: transform var(--transition); flex-shrink: 0; }
  .folder-arrow.open { transform: rotate(90deg); }
  .folder-children { display: none; padding-left: 14px; }
  .folder-children.open { display: block; }
  .folder-note-item {
    padding: 6px 10px 6px 12px;
    margin: 1px 8px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.83rem;
    color: var(--text3);
    transition: all var(--transition);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    display: flex; align-items: center; gap: 6px;
    user-select: none;
    -webkit-user-drag: auto;
  }
  .folder-note-item:hover { background: var(--bg3); color: var(--text2); }
  .folder-note-item.active { color: var(--accent2); background: var(--accent-glow); }
  .folder-note-item.dragging { opacity: 0.5; }
  .folder-header.drag-over { background: var(--accent-glow); border-color: var(--accent); }

  /* MAIN */
  .main { flex: 1; display: flex; flex-direction: column; min-width: 0; overflow: hidden; }

  /* TOPBAR */
  .topbar {
    height: 54px;
    background: var(--bg2);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 10px;
    padding: 0 16px;
    flex-shrink: 0;
    z-index: 5;
  }
  .topbar-btn {
    width: 34px; height: 34px; border-radius: 7px;
    display: flex; align-items: center; justify-content: center;
    background: transparent; border: none; cursor: pointer;
    color: var(--text2); font-size: 1.05rem;
    transition: all var(--transition);
    flex-shrink: 0;
  }
  .topbar-btn:hover { background: var(--bg3); color: var(--text); }
  .topbar-title { font-weight: 700; font-size: 1rem; flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .topbar-actions { display: flex; align-items: center; gap: 6px; }

  /* VIEW TOGGLE */
  .view-toggle { display: flex; background: var(--bg3); border-radius: 7px; padding: 2px; gap: 1px; }
  .view-btn { width: 28px; height: 28px; border-radius: 5px; border: none; background: transparent; color: var(--text2); cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; transition: all var(--transition); }
  .view-btn:hover { background: var(--bg4); color: var(--text); }
  .view-btn.active { background: var(--bg2); color: var(--accent); box-shadow: 0 1px 4px rgba(0,0,0,0.2); }

  /* CONTENT AREA */
  .content-area {
    flex: 1; overflow-y: auto; padding: 24px 28px;
    position: relative;
  }
  .content-area::-webkit-scrollbar { width: 5px; }
  .content-area::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  /* PAGE HEADER */
  .page-header { margin-bottom: 24px; }
  .page-title { font-size: 1.7rem; font-weight: 800; letter-spacing: -0.5px; }
  .page-meta { color: var(--text3); font-size: 0.82rem; margin-top: 5px; font-family: var(--mono); }

  /* TAG FILTER */
  .tag-filter-bar { display: flex; flex-wrap: wrap; gap: 7px; margin-bottom: 20px; align-items: center; }
  .tag-chip {
    padding: 4px 12px; border-radius: 20px;
    font-size: 0.78rem; font-weight: 600;
    cursor: pointer; border: 1px solid var(--border);
    background: var(--bg3); color: var(--text2);
    transition: all var(--transition);
  }
  .tag-chip:hover { border-color: var(--accent); color: var(--accent); }
  .tag-chip.active { background: var(--accent); border-color: var(--accent); color: #fff; }
  .tag-chip.all { border-style: dashed; }

  /* NOTES GRID */
  .notes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 14px;
  }
  .notes-list { display: flex; flex-direction: column; gap: 8px; }
  .notes-tree { display: flex; flex-direction: column; gap: 8px; }

  .note-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 16px;
    cursor: pointer;
    transition: all var(--transition);
    position: relative;
    overflow: hidden;
  }
  .note-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: var(--accent);
    transform: scaleX(0); transform-origin: left;
    transition: transform var(--transition);
  }
  .note-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.18); }
  .note-card:hover::before { transform: scaleX(1); }
  .note-card-icon { font-size: 1.6rem; margin-bottom: 10px; }
  .note-card-name { font-weight: 700; font-size: 0.95rem; margin-bottom: 8px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .note-card-meta { display: flex; flex-wrap: wrap; gap: 5px; }
  .note-tag { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 20px; font-size: 0.72rem; font-weight: 600; background: var(--accent-glow); color: var(--accent2); }
  .note-folder-path { font-size: 0.72rem; color: var(--text3); font-family: var(--mono); margin-top: 4px; }
  .note-card-actions { display: flex; gap: 5px; margin-top: 12px; opacity: 0; transition: opacity var(--transition); }
  .note-card:hover .note-card-actions { opacity: 1; }
  .note-act-btn {
    flex: 1; padding: 5px 8px; border-radius: 6px; border: 1px solid var(--border);
    background: var(--bg3); color: var(--text2); font-size: 0.75rem; font-family: var(--font);
    cursor: pointer; transition: all var(--transition); font-weight: 600;
  }
  .note-act-btn:hover { background: var(--bg4); color: var(--text); }
  .note-act-btn.danger:hover { background: rgba(255,91,107,0.15); color: var(--danger); border-color: var(--danger); }

  /* UPDATE WINDOW */
  .update-window {
    position: absolute;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 12px;
    box-shadow: 0 20px 80px rgba(0,0,0,0.5);
    display: flex; flex-direction: column;
    overflow: visible;
    min-width: 300px; min-height: auto;
    padding: 16px;
    z-index: 46;
  }
  .update-window-title {
    font-weight: 700; font-size: 0.95rem; margin-bottom: 12px; color: var(--text);
  }
  .update-window-btn {
    width: 100%; padding: 10px; margin-bottom: 8px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 6px; cursor: pointer; color: var(--text2);
    font-family: var(--font); font-weight: 600; font-size: 0.9rem;
    transition: all var(--transition);
  }
  .update-window-btn:hover {
    background: var(--bg4); color: var(--text);
  }
  .update-window-btn:last-child { margin-bottom: 0; }

  /* LIST VIEW */
  .note-list-item {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    cursor: pointer;
    display: flex; align-items: center; gap: 12px;
    transition: all var(--transition);
  }
  .note-list-item:hover { border-color: var(--accent); background: var(--bg3); }
  .note-list-icon { font-size: 1.2rem; flex-shrink: 0; }
  .note-list-name { font-weight: 600; font-size: 0.92rem; flex: 1; }
  .note-list-tags { display: flex; gap: 5px; flex-wrap: wrap; }
  .note-list-path { font-size: 0.75rem; color: var(--text3); font-family: var(--mono); }
  .note-list-actions { display: flex; gap: 5px; opacity: 0; transition: opacity var(--transition); }
  .note-list-item:hover .note-list-actions { opacity: 1; }

  /* BUTTONS */
  .btn-primary {
    background: var(--accent);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px 16px;
    font-family: var(--font);
    font-weight: 700;
    font-size: 0.88rem;
    cursor: pointer;
    transition: all var(--transition);
    display: inline-flex; align-items: center; gap: 6px;
  }
  .btn-primary:hover { opacity: 0.88; transform: translateY(-1px); }
  .btn-secondary {
    background: var(--bg3);
    color: var(--text2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 14px;
    font-family: var(--font);
    font-weight: 600;
    font-size: 0.88rem;
    cursor: pointer;
    transition: all var(--transition);
  }
  .btn-secondary:hover { background: var(--bg4); color: var(--text); }

  /* UPLOAD DROP ZONE */
  .upload-zone {
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 32px 24px;
    text-align: center;
    cursor: pointer;
    transition: all var(--transition);
    margin-bottom: 24px;
    background: var(--bg2);
  }
  .upload-zone:hover, .upload-zone.dragover {
    border-color: var(--accent);
    background: var(--accent-glow);
  }
  .upload-zone .upload-icon { font-size: 2rem; margin-bottom: 10px; }
  .upload-zone p { color: var(--text2); font-size: 0.88rem; }
  .upload-zone strong { color: var(--accent); }

  /* NOTE VIEWER OVERLAY */
  #note-viewer {
    display: none;
    position: fixed; inset: 0; z-index: 50;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px);
  }
  #note-viewer.open { display: flex; }
  
  /* FLOATING NOTE WINDOWS CONTAINER */
  #floating-windows {
    position: fixed; inset: 0; z-index: 45; pointer-events: none;
  }
  #floating-windows .note-window { pointer-events: all; }
  #floating-windows .update-window { pointer-events: all; }
  
  .note-window {
    position: absolute;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    box-shadow: 0 20px 80px rgba(0,0,0,0.5);
    display: flex; flex-direction: column;
    overflow: hidden;
    min-width: 320px; min-height: 200px;
    transition: box-shadow 0.2s ease;
  }
  .note-window.active { box-shadow: 0 20px 100px rgba(124,109,250,0.4); }
  .note-window-titlebar {
    height: 42px;
    background: var(--bg3);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 8px;
    padding: 0 12px;
    cursor: grab; user-select: none;
    flex-shrink: 0;
  }
  .note-window-titlebar:active { cursor: grabbing; }
  .win-title { flex: 1; font-size: 0.88rem; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .win-btn { width: 26px; height: 26px; border-radius: 50%; border: none; cursor: pointer; font-size: 0.75rem; display: flex; align-items: center; justify-content: center; transition: all var(--transition); flex-shrink: 0; background: var(--bg4); color: var(--text2); }
  .win-btn:hover { background: var(--border); color: var(--text); }
  .win-btn.close { background: var(--danger); color: #fff; }
  .win-btn.fullscreen { background: var(--success); color: #fff; }
  .win-btn.close:hover, .win-btn.fullscreen:hover { opacity: 0.8; transform: scale(1.1); }
  .note-window-body { flex: 1; overflow: hidden; position: relative; }
  .note-window-body iframe { width: 100%; height: 100%; border: none; background: #fff; }
  .resize-handle {
    position: absolute; bottom: 0; right: 0;
    width: 18px; height: 18px;
    cursor: se-resize;
    display: flex; align-items: flex-end; justify-content: flex-end;
    padding: 3px;
    color: var(--text3);
    font-size: 0.7rem;
    z-index: 2;
  }
  .note-window.fullscreen-win {
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    border-radius: 0;
    top: 0 !important;
    left: 0 !important;
    transform: none !important;
  }
  .note-window.fullscreen-win .resize-handle { display: none; }
  .note-window.fullscreen-win .note-window-titlebar { display: none; }
  .note-window.fullscreen-win .note-window-body { height: 100%; }

  /* MODAL */
  .modal-overlay {
    display: none; position: fixed; inset: 0; z-index: 60;
    background: rgba(0,0,0,0.55); backdrop-filter: blur(4px);
    align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 28px 28px 24px;
    width: 90%; max-width: 420px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
  }
  .modal h3 { font-size: 1.15rem; font-weight: 800; margin-bottom: 16px; }
  .modal input, .modal select {
    width: 100%; background: var(--bg3); border: 1px solid var(--border);
    border-radius: 8px; padding: 10px 12px; color: var(--text);
    font-family: var(--font); font-size: 0.9rem; margin-bottom: 10px; outline: none;
    transition: border var(--transition);
  }
  .modal input:focus, .modal select:focus { border-color: var(--accent); }
  .modal-actions { display: flex; gap: 8px; margin-top: 6px; justify-content: flex-end; }
  .modal label { font-size: 0.8rem; color: var(--text2); display: block; margin-bottom: 4px; font-weight: 600; letter-spacing: 0.3px; }

  /* TAGS INPUT */
  .tags-input-wrap { display: flex; flex-wrap: wrap; gap: 5px; background: var(--bg3); border: 1px solid var(--border); border-radius: 8px; padding: 7px; margin-bottom: 10px; cursor: text; }
  .tags-input-wrap:focus-within { border-color: var(--accent); }
  .tag-pill { background: var(--accent); color: #fff; border-radius: 20px; padding: 2px 8px 2px 10px; font-size: 0.77rem; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; }
  .tag-pill-remove { cursor: pointer; opacity: 0.7; font-size: 0.8rem; }
  .tag-pill-remove:hover { opacity: 1; }
  .tags-input-wrap input { border: none; background: transparent; outline: none; font-family: var(--font); color: var(--text); font-size: 0.88rem; flex: 1; min-width: 80px; }

  /* SETTINGS / WALLPAPER PANEL */
  .settings-panel {
    display: none; flex-direction: column; gap: 12px; padding: 24px 28px;
    overflow-y: auto; flex: 1;
  }
  .settings-panel.open { display: flex; }
  .settings-section-title { font-size: 0.7rem; font-weight: 700; letter-spacing: 1.2px; text-transform: uppercase; color: var(--text3); margin-bottom: 4px; margin-top: 8px; }
  .theme-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
  .theme-opt {
    border-radius: 9px; padding: 12px 8px; text-align: center; cursor: pointer;
    border: 2px solid transparent; font-size: 0.8rem; font-weight: 700;
    transition: all var(--transition);
  }
  .theme-opt:hover { transform: scale(1.03); }
  .theme-opt.active { border-color: var(--accent); }
  .theme-opt.dark { background: #0f0f11; color: #e8e8f0; }
  .theme-opt.light { background: #f5f4f8; color: #18181f; }
  .theme-opt.navy { background: #0a0f1e; color: #d0dcff; }
  .accent-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
  .accent-opt {
    height: 36px; border-radius: 8px; cursor: pointer; border: 2px solid transparent;
    transition: all var(--transition);
  }
  .accent-opt:hover { transform: scale(1.05); }
  .accent-opt.active { border-color: var(--text); }
  .wallpaper-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
  .wp-opt {
    height: 60px; border-radius: 8px; cursor: pointer; border: 2px solid transparent;
    transition: all var(--transition); overflow: hidden; position: relative;
    background-size: cover; background-position: center;
  }
  .wp-opt:hover { border-color: var(--accent); }
  .wp-opt.active { border-color: var(--accent); }
  .wp-none { display: flex; align-items: center; justify-content: center; background: var(--bg3); font-size: 0.8rem; color: var(--text2); font-weight: 600; }
  .wp-custom-btn { grid-column: span 3; }

  /* EMPTY STATE */
  .empty-state { text-align: center; padding: 60px 20px; color: var(--text3); }
  .empty-state .empty-icon { font-size: 3rem; margin-bottom: 14px; }
  .empty-state p { font-size: 0.9rem; }

  /* FOLDER FORM */
  .new-folder-btn {
    display: flex; align-items: center; gap: 7px;
    padding: 7px 14px; margin: 2px 8px;
    border-radius: 7px; cursor: pointer;
    font-size: 0.82rem; font-weight: 600; color: var(--accent2);
    border: 1px dashed var(--border); background: transparent;
    width: calc(100% - 16px); transition: all var(--transition);
  }
  .new-folder-btn:hover { border-color: var(--accent); background: var(--accent-glow); }

  /* TOAST */
  #toast {
    position: fixed; top: 24px; left: 50%; transform: translateX(-50%) translateY(-80px);
    background: var(--bg3); border: 1px solid var(--border); border-radius: 8px;
    padding: 10px 18px; font-size: 0.88rem; font-weight: 600;
    z-index: 200; transition: transform 0.3s ease; pointer-events: none;
    white-space: nowrap;
  }
  #toast.show { transform: translateX(-50%) translateY(0); }

  /* SIDEBAR BOTTOM NAV */
  .sidebar-bottom-nav {
    display: flex; align-items: center; gap: 2px;
    padding: 8px 10px;
    padding-bottom: calc(8px + env(safe-area-inset-bottom));
    border-top: 1px solid var(--border);
    flex-shrink: 0;
    background: var(--bg2);
  }
  .sb-nav-btn {
    width: 36px; height: 36px; border-radius: 8px;
    border: none; background: transparent;
    cursor: pointer; font-size: 1.1rem;
    display: flex; align-items: center; justify-content: center;
    color: var(--text2);
    transition: all var(--transition);
    flex-shrink: 0;
  }
  .sb-nav-btn:hover { background: var(--bg3); color: var(--text); }
  .sb-nav-btn.active { background: var(--accent-glow); color: var(--accent2); }
  .user-avatar {
    width: 32px; height: 32px; border-radius: 50%;
    background: var(--accent);
    display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 0.85rem; color: #fff;
    flex-shrink: 0;
  }

  /* SEARCH TAG INDICATOR */
  .active-tag-indicator {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 12px;
    background: var(--accent-glow);
    border-radius: 8px;
    font-size: 0.84rem;
    color: var(--accent2);
    margin-bottom: 16px;
  }
  .clear-tag { cursor: pointer; font-size: 0.9rem; margin-left: auto; }

  /* MOBILE */
  
    .sidebar-bottom-nav { display: none !important; }
  }

  /* Mobile bottom nav bar */
  .mobile-bottom-nav {
    display: none;
    position: fixed;
    bottom: 0; left: 0; right: 0;
    height: 56px;
    background: var(--bg2);
    border-top: 1px solid var(--border);
    z-index: 30;
    align-items: center;
    justify-content: space-around;
    padding-bottom: env(safe-area-inset-bottom);
    flex-shrink: 0;
  }
  .mob-nav-btn {
    flex: 1; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    background: transparent; border: none; cursor: pointer;
    color: var(--text2); font-size: 0.62rem; font-weight: 600;
    gap: 3px; transition: all var(--transition);
    padding: 0;
  }
  .mob-nav-btn svg { flex-shrink: 0; }
  .mob-nav-btn.active { color: var(--accent); }
  .mob-nav-btn.active .dt-bg { fill: var(--accent); opacity: 0.3; }
  .mob-nav-btn.active .dt-stroke { stroke: var(--accent); }
  .mob-nav-btn.active .dt-stroke-only { stroke: var(--accent); }
  .mob-nav-btn:hover { color: var(--text); }

  @media (max-width: 420px) {
    .notes-grid { grid-template-columns: 1fr; }
  }

  ::-webkit-scrollbar { width: 5px; height: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  /* LOADING OVERLAY */
  #app-loading {
    position: fixed; inset: 0; z-index: 999;
    background: var(--bg);
    display: flex; align-items: center; justify-content: center;
    flex-direction: column; gap: 16px;
  }
  #app-loading .spin {
    width: 36px; height: 36px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  #app-loading .load-logo { font-size: 1.8rem; font-weight: 800; }
  #app-loading .load-logo span { color: var(--accent); }

  /* HOME BREADCRUMB */
  .home-breadcrumb {
    display: flex; align-items: center; flex-wrap: wrap; gap: 4px;
    margin-bottom: 16px; font-size: 0.82rem; font-weight: 600;
  }
  .bc-item {
    color: var(--text3); cursor: pointer; padding: 3px 6px;
    border-radius: 5px; transition: all var(--transition);
  }
  .bc-item:hover { color: var(--accent); background: var(--accent-glow); }
  .bc-item.current { color: var(--text); cursor: default; }
  .bc-item.current:hover { background: transparent; color: var(--text); }
  .bc-sep { color: var(--text3); opacity: 0.4; font-size: 0.75rem; }

  /* FOLDER CARD GRID */
  .folder-card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 14px;
    margin-bottom: 24px;
  }
  .folder-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 18px 16px 14px;
    cursor: pointer;
    transition: all var(--transition);
    position: relative;
    overflow: hidden;
  }
  .folder-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 3px;
    background: var(--accent);
    transform: scaleX(0); transform-origin: left;
    transition: transform var(--transition);
  }
  .folder-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.18); }
  .folder-card:hover::before { transform: scaleX(1); }
  .folder-card-icon {
    width: 44px; height: 44px; border-radius: 10px;
    background: var(--accent-glow);
    display: flex; align-items: center; justify-content: center;
    margin-bottom: 12px;
  }
  .folder-card-name {
    font-weight: 800; font-size: 1rem; margin-bottom: 6px;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .folder-card-meta {
    font-size: 0.75rem; color: var(--text3); font-family: var(--mono);
    display: flex; gap: 10px; flex-wrap: wrap;
  }
  .folder-card-meta span { display: flex; align-items: center; gap: 3px; }

  /* SUBFOLDER PILLS inside folder card */
  .folder-card-subs {
    display: flex; flex-wrap: wrap; gap: 5px; margin-top: 10px;
  }
  .folder-sub-pill {
    font-size: 0.7rem; font-weight: 600;
    padding: 2px 8px; border-radius: 20px;
    background: var(--bg3); color: var(--text3);
    border: 1px solid var(--border);
    white-space: nowrap;
  }

  /* SECTION DIVIDER for notes below folders */
  .home-section-title {
    font-size: 0.7rem; font-weight: 700; letter-spacing: 1.2px;
    text-transform: uppercase; color: var(--text3);
    margin: 20px 0 10px; padding: 0 2px;
    display: flex; align-items: center; gap: 8px;
  }
  .home-section-title::after {
    content: ''; flex: 1; height: 1px; background: var(--border);
  }

  @media (max-width: 700px) {
    .folder-card-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
  }
  @media (max-width: 420px) {
    .folder-card-grid { grid-template-columns: 1fr; }
  }

  /* LOGOUT BUTTON - always red */
  .logout-btn { color: var(--danger) !important; }
  .logout-btn .dt-bg { fill: var(--danger) !important; opacity: 0.2 !important; }
  .logout-btn .dt-stroke { stroke: var(--danger) !important; }
  .logout-btn:hover { background: rgba(255,91,107,0.15) !important; color: var(--danger) !important; }
  .mob-nav-btn.logout-btn { color: var(--danger) !important; }
  .mob-nav-btn.logout-btn .dt-stroke { stroke: var(--danger) !important; }
  .mob-nav-btn.logout-btn .dt-bg { fill: var(--danger) !important; opacity: 0.2 !important; }

  /* FOLDER DRAG-OVER highlight */
  .folder-header.drag-over {
    background: var(--accent-glow) !important;
    border: 1px dashed var(--accent) !important;
    border-radius: 7px;
  }
  .folder-drop-hint { font-size: 0.7rem; color: var(--accent2); padding: 3px 10px 5px 28px; display: none; }
  .folder-header.drag-over + .folder-drop-hint { display: block; }

  /* FOLDER CONTEXT MENU (right-click) */
  .folder-ctx-menu {
    position: fixed; z-index: 300;
    background: var(--bg2); border: 1px solid var(--border);
    border-radius: 9px; padding: 5px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.35);
    min-width: 150px;
    display: none;
  }
  .folder-ctx-menu.open { display: block; }
  .ctx-item {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 12px; border-radius: 6px;
    font-size: 0.84rem; font-weight: 600; cursor: pointer;
    color: var(--text2); transition: all var(--transition);
  }
  .ctx-item:hover { background: var(--bg3); color: var(--text); }
  .ctx-item.danger { color: var(--danger); }
  .ctx-item.danger:hover { background: rgba(255,91,107,0.12); }

  /* PROFILE PANEL */
  #profile-panel {
    position: fixed; inset: 0; z-index: 200;
    display: none; align-items: flex-end; justify-content: flex-start;
  }
  #profile-panel.open { display: flex; }
  .profile-backdrop {
    position: absolute; inset: 0;
    background: rgba(0,0,0,0.4); backdrop-filter: blur(3px);
  }
  .profile-sheet {
    position: relative; z-index: 1;
    background: var(--bg2); border: 1px solid var(--border);
    border-radius: 16px; margin: 12px;
    width: 300px; max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    display: flex; flex-direction: column;
  }
  @media (max-width: 700px) {
    #profile-panel { align-items: flex-end; justify-content: center; }
    .profile-sheet { width: calc(100% - 24px); margin: 12px; border-radius: 20px 20px 12px 12px; }
  }
  .profile-header {
    padding: 20px 20px 14px;
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 12px;
  }
  .profile-avatar-big {
    width: 46px; height: 46px; border-radius: 50%;
    background: var(--accent); color: #fff;
    display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 1.3rem; flex-shrink: 0;
  }
  .profile-name { font-weight: 800; font-size: 1rem; }
  .profile-email { font-size: 0.75rem; color: var(--text3); font-family: var(--mono); margin-top: 2px; }
  .profile-close {
    margin-left: auto; width: 28px; height: 28px; border-radius: 50%;
    border: none; background: var(--bg3); cursor: pointer; color: var(--text2);
    display: flex; align-items: center; justify-content: center; font-size: 1rem;
    transition: all var(--transition); flex-shrink: 0;
  }
  .profile-close:hover { background: var(--bg4); color: var(--text); }
  .profile-section { padding: 14px 16px 6px; }
  .profile-section-title {
    font-size: 0.68rem; font-weight: 700; letter-spacing: 1.2px;
    text-transform: uppercase; color: var(--text3); margin-bottom: 10px;
  }
  .profile-theme-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 7px; margin-bottom: 4px; }
  .profile-theme-opt {
    border-radius: 8px; padding: 10px 6px; text-align: center;
    cursor: pointer; border: 2px solid transparent;
    font-size: 0.75rem; font-weight: 700; transition: all var(--transition);
  }
  .profile-theme-opt:hover { transform: scale(1.04); }
  .profile-theme-opt.active { border-color: var(--accent); }
  .profile-theme-opt.dark { background:#0f0f11; color:#e8e8f0; }
  .profile-theme-opt.light { background:#f5f4f8; color:#18181f; }
  .profile-theme-opt.navy { background:#0a0f1e; color:#d0dcff; }
  .profile-accent-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 7px; margin-bottom: 4px; }
  .profile-accent-opt {
    height: 32px; border-radius: 7px; cursor: pointer;
    border: 2px solid transparent; transition: all var(--transition);
  }
  .profile-accent-opt:hover { transform: scale(1.06); }
  .profile-accent-opt.active { border-color: var(--text); }

  /* TEXT STYLE OPTIONS */
  .text-style-grid { display: flex; flex-direction: column; gap: 6px; }
  .text-style-opt {
    padding: 10px 13px; border-radius: 8px; cursor: pointer;
    border: 1.5px solid var(--border); background: var(--bg3);
    transition: all var(--transition); display: flex; flex-direction: column; gap: 2px;
  }
  .text-style-opt:hover { border-color: var(--accent); }
  .text-style-opt.active { border-color: var(--accent); background: var(--accent-glow); }
  .text-style-preview { font-size: 0.95rem; font-weight: 600; color: var(--text); }
  .text-style-label { font-size: 0.68rem; color: var(--text3); font-weight: 600; letter-spacing: 0.3px; }

  /* FONT SIZE SLIDER */
  .font-size-row { display: flex; align-items: center; gap: 10px; margin-bottom: 4px; }
  .font-size-row input[type=range] {
    flex: 1; -webkit-appearance: none; height: 4px;
    background: var(--bg4); border-radius: 4px; outline: none;
    border: none; margin: 0; padding: 0;
  }
  .font-size-row input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none; width: 16px; height: 16px;
    border-radius: 50%; background: var(--accent); cursor: pointer;
  }
  .font-size-val { font-size: 0.78rem; color: var(--text2); font-family: var(--mono); min-width: 30px; text-align: right; }

  /* PROFILE DIVIDER */
  .profile-divider { height: 1px; background: var(--border); margin: 6px 16px; }

  /* REUPLOAD modal */
  #reupload-modal .reupload-zone {
    border: 2px dashed var(--border); border-radius: 10px;
    padding: 24px; text-align: center; cursor: pointer;
    transition: all var(--transition); background: var(--bg3); margin-bottom: 12px;
  }
  #reupload-modal .reupload-zone:hover,
  #reupload-modal .reupload-zone.dragover { border-color: var(--accent); background: var(--accent-glow); }
  #reupload-modal .reupload-zone p { color: var(--text2); font-size: 0.85rem; }
  #reupload-modal .reupload-zone strong { color: var(--accent); }

  .page-hidden { display: none !important; }

  select option { background: var(--bg2); color: var(--text); }
  .modal select option { background: var(--bg2); color: var(--text); }

  
/* EXACT LOGO DESIGN FOR 'Z' */
  .load-logo span, 
  .login-logo span.z, 
  .sidebar-logo span.z {
    color: var(--accent);
    -webkit-background-clip: unset;
    -webkit-text-fill-color: var(--accent);
    background-clip: unset;
    display: inline-block;
    filter: drop-shadow(0 0 5px var(--accent-glow));
    transition: color var(--transition);
  }


/* UNIFIED SIDEBAR & PROFILE */
.sidebar {
  display: flex;
  flex-direction: column;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s ease;
}

.profile-trigger {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  margin: 8px;
  border-radius: 12px;
  cursor: pointer;
  background: var(--bg3);
  border: 1px solid var(--border);
  transition: all var(--transition);
}

.profile-trigger:hover {
  background: var(--bg4);
  border-color: var(--accent);
}

.profile-trigger .avatar-circle {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: var(--accent);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  color: white;
  font-size: 1.1rem;
  overflow: hidden;
  border: 2px solid var(--border);
}

.profile-trigger .user-info {
  flex: 1;
  overflow: hidden;
}

.profile-trigger .user-name {
  font-weight: 700;
  font-size: 0.88rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.profile-trigger .user-sub {
  font-size: 0.65rem;
  color: var(--text3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* MOBILE FIXES */
@media (max-width: 850px) {
  .sidebar {
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    z-index: 1000;
    transform: translateX(-100%);
    box-shadow: none;
    padding-bottom: env(safe-area-inset-bottom);
  }
  .sidebar.mobile-active {
    transform: translateX(0);
    box-shadow: 20px 0 50px rgba(0,0,0,0.5);
  }
  .mobile-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    z-index: 999;
  }
  .mobile-overlay.active {
    display: block;
  }
}

  .n-logo-svg { width: 32px; height: 32px; flex-shrink: 0; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); }
  .logo-dot { display: none !important; } /* Hide the old dot */
  .sidebar-logo { gap: 10px; padding: 18px 20px; }
  .load-logo-wrap { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-bottom: 20px; }
  .load-logo-wrap .n-logo-svg { width: 64px; height: 64px; }
</style>
</head>
<body>

<!-- LOADING OVERLAY -->
<div id="app-loading">
  <div class="spin"></div>
</div>

<!-- TOAST -->
<div id="toast"></div>

<!-- LOGIN SCREEN -->
<div id="login-screen">
  <div class="login-card">
    <div class="login-logo">Note<span class="z">Z</span></div>
    <div class="login-sub">Your personal HTML notes workspace</div>
    <div class="login-tabs">
      <button class="login-tab active" id="tab-login" onclick="switchLoginTab('login')">Sign In</button>
      <button class="login-tab" id="tab-signup" onclick="switchLoginTab('signup')">Sign Up</button>
    </div>
    <div id="login-form">
      <input type="text" id="login-username" placeholder="Username or Email" autocomplete="username">
      <input type="password" id="login-password" placeholder="Password" autocomplete="current-password">
      <button class="btn-primary" style="width:100%;margin-top:6px;padding:13px" onclick="doLogin()">Sign In →</button>
      <div class="login-err" id="login-err"></div>
    </div>
    <div id="signup-form" style="display:none">
      <input type="text" id="signup-username" placeholder="Choose a username" autocomplete="username">
      <input type="email" id="signup-email" placeholder="Email (optional)">
      <input type="password" id="signup-password" placeholder="Password">
      <input type="password" id="signup-confirm" placeholder="Confirm password">
      <button class="btn-primary" style="width:100%;margin-top:6px;padding:13px" onclick="doSignup()">Create Account →</button>
      <div class="login-err" id="signup-err"></div>
    </div>
  </div>
</div>

<!-- MAIN APP -->
<div id="app" style="display:none">
  <!-- Mobile overlay -->
  <div class="mobile-overlay" id="mobile-overlay" style="z-index:998" onclick="closeMobileSidebar()"></div>

  <!-- SIDEBAR -->
  <div class="sidebar" id="sidebar">
    
    <div class="sidebar-logo">
      <img id="sidebar-logo-icon" src="data:image/png;base64,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" style="width:36px;height:36px;object-fit:contain;flex-shrink:0;border-radius:50%;transition:filter 0.3s;"></div>
      Note<span class="z">Z</span>
    </div>
    <div class="profile-trigger" onclick="openProfilePanel()">
        <div class="avatar-circle" id="sb-avatar">U</div>
        <div class="user-info">
            <div class="user-name" id="sb-username">User</div>
            <div class="user-sub">Settings & Profile</div>
        </div>
        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="var(--text3)" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
    </div>
    <div class="sidebar-scroll">

      <div style="height:8px"></div>
      <div class="sidebar-section" onclick="toggleSidebarSection('folder-tree', this)" style="cursor:pointer; display:flex; align-items:center; gap:8px;"><span class="sec-arrow" style="transition:0.2s">▼</span> Folders</div>
      <div id="folder-tree"></div>
      
    
    </div> <!-- Close sidebar-scroll -->
    
    <div style="padding: 10px; display: flex; gap: 8px; border-top: 1px solid var(--border);">
        <button class="new-folder-btn" onclick="openNewFolderModal()" style="margin:0; flex: 1; padding: 10px; justify-content: center;">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            New Folder
        </button>
        <button class="sb-nav-btn" onclick="navigate('home'); navigateHome(null);" title="Go Home" style="width:42px; height:42px; background: var(--bg3); border: 1px solid var(--border); margin:0;">
            <svg viewBox="0 0 24 24" class="dt-icon"><path class="dt-bg" d="M3 10.5L12 3l9 7.5V20a1 1 0 01-1 1H4a1 1 0 01-1-1V10.5z"/><path class="dt-stroke" d="M3 10.5L12 3l9 7.5" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path class="dt-stroke" d="M9 21v-6h6v6" fill="none" stroke-width="1.8" stroke-linecap="round"/></svg>
        </button>
    </div>


    <!-- BOTTOM NAV -->
    <div class="sidebar-bottom-nav">
      <div class="user-avatar" id="user-avatar-text" title="Profile & Settings" style="cursor:pointer" onclick="openProfilePanel()">U</div>
      <!-- Home -->
      <button class="sb-nav-btn active" id="nav-home" onclick="navigate('home'); navigateHome(null);" title="All Notes">
        <svg viewBox="0 0 24 24" class="dt-icon"><path class="dt-bg" d="M3 10.5L12 3l9 7.5V20a1 1 0 01-1 1H4a1 1 0 01-1-1V10.5z"/><path class="dt-stroke" d="M3 10.5L12 3l9 7.5" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path class="dt-stroke" d="M9 21v-6h6v6" fill="none" stroke-width="1.8" stroke-linecap="round"/></svg>
      </button>
      <!-- Upload -->
      <button class="sb-nav-btn" id="nav-upload" onclick="navigate('upload')" title="Upload">
        <svg viewBox="0 0 24 24" class="dt-icon"><rect class="dt-bg" x="3" y="15" width="18" height="6" rx="1"/><path class="dt-stroke" d="M12 3v12M7 8l5-5 5 5" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
      <!-- Settings -->
      <button class="sb-nav-btn" id="nav-settings" onclick="navigate('settings')" title="Settings">
        <svg viewBox="0 0 24 24" class="dt-icon"><circle class="dt-bg" cx="12" cy="12" r="9"/><circle class="dt-stroke-only" cx="12" cy="12" r="3" fill="none" stroke-width="1.8"/><path class="dt-stroke" d="M12 5v2M12 17v2M5 12H3M21 12h-2M7.05 7.05L5.64 5.64M18.36 18.36l-1.41-1.41M7.05 16.95l-1.41 1.41M18.36 5.64l-1.41 1.41" fill="none" stroke-width="1.8" stroke-linecap="round"/></svg>
      </button>
    </div>
  </div>

  <!-- MAIN -->
  <div class="main">
    <!-- TOPBAR -->
    <div class="topbar">
      <button class="topbar-btn" id="sidebar-toggle" onclick="toggleSidebar()" title="Toggle sidebar">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <div class="topbar-title" id="topbar-title">All Notes</div>
      <div class="topbar-actions">
        <div class="view-toggle" id="view-toggle">
          <!-- Grid -->
          <button class="view-btn active" id="view-grid" onclick="setView('grid')" title="Grid View">
            <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          </button>
          <!-- Tree -->
          <button class="view-btn" id="view-tree" onclick="setView('tree')" title="Tree View">
            <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><path d="M3 5h3M3 12h3M3 19h3M8 5h10M8 12h10M8 19h10"/><path d="M5 3v2M5 10v2M5 17v2"/></svg>
          </button>
          <!-- List -->
          <button class="view-btn" id="view-list" onclick="setView('list')" title="List View">
            <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><circle cx="3.5" cy="6" r="1" fill="currentColor"/><circle cx="3.5" cy="12" r="1" fill="currentColor"/><circle cx="3.5" cy="18" r="1" fill="currentColor"/></svg>
          </button>
        </div>
        <button class="btn-primary" onclick="navigate('upload')" style="padding:7px 13px;font-size:0.82rem">+ Upload</button>
      </div>
    </div>

    <!-- HOME PAGE -->
    <div id="page-home" class="content-area">
      <!-- Breadcrumb nav -->
      <div id="home-breadcrumb" class="home-breadcrumb" style="display:none"></div>
      <div class="page-header" id="home-page-header">
        <div class="page-title" id="home-page-title">All Notes</div>
        <div class="page-meta" id="notes-count-meta">0 notes</div>
      </div>
      <div id="tag-filter-bar" class="tag-filter-bar"></div>
      <div id="active-tag-indicator" class="active-tag-indicator" style="display:none">
        <span>Filtering by: <strong id="active-tag-label"></strong></span>
        <span class="clear-tag" onclick="clearTagFilter()">✕</span>
      </div>
      <div id="notes-container"></div>
      <div id="empty-state" class="empty-state" style="display:none">
        <div class="empty-icon">
          <svg viewBox="0 0 64 64" width="52" height="52"><path d="M8 20h48v36a2 2 0 01-2 2H10a2 2 0 01-2-2V20z" fill="var(--accent)" opacity="0.12"/><path d="M8 20l8-12h16l4 6h20a2 2 0 012 2" fill="none" stroke="var(--text3)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 40h16M24 48h10" fill="none" stroke="var(--text3)" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <p>No notes yet. Upload some HTML files to get started!</p>
      </div>
    </div>

    <!-- UPLOAD PAGE -->
    <div id="page-upload" class="content-area page-hidden">
      <div class="page-header">
        <div class="page-title">Upload Note</div>
        <div class="page-meta">Drop HTML files to add them to NoteZ</div>
      </div>
      <div class="upload-zone" id="upload-zone" onclick="document.getElementById('file-input').click()">
        <div class="upload-icon">
          <svg viewBox="0 0 48 48" width="44" height="44">
            <rect x="6" y="28" width="36" height="14" rx="3" fill="var(--accent)" opacity="0.18"/>
            <path d="M24 6v26M14 16l10-10 10 10" fill="none" stroke="var(--accent2)" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p><strong>Click or drag & drop</strong> HTML files here</p>
        <p style="margin-top:6px;font-size:0.8rem;color:var(--text3)">Only .html files are accepted</p>
      </div>
      <input type="file" id="file-input" accept=".html,.htm" multiple style="display:none" onchange="handleFiles(this.files)">

      <div id="upload-form" style="display:none">
        <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px 22px;margin-bottom:14px">
          <div id="upload-file-name" style="font-weight:700;font-size:1rem;margin-bottom:16px"></div>

          <label style="font-size:0.8rem;color:var(--text2);display:block;margin-bottom:4px;font-weight:600;letter-spacing:0.3px;">Note Name</label>
          <input type="text" id="upload-name" placeholder="Name your note" style="width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 12px;color:var(--text);font-family:var(--font);font-size:0.9rem;margin-bottom:10px;outline:none;transition:border var(--transition);">

          <label style="font-size:0.8rem;color:var(--text2);display:block;margin-bottom:4px;font-weight:600;letter-spacing:0.3px;">Folder</label>
          <select id="upload-folder" required style="width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 12px;color:var(--text);font-family:var(--font);font-size:0.9rem;margin-bottom:10px;outline:none;transition:border var(--transition);">
            <option value="" disabled selected>— Select a folder —</option>
          </select>

          <label style="font-size:0.8rem;color:var(--text2);display:block;margin-bottom:4px;font-weight:600;letter-spacing:0.3px;">Tags (press Enter to add)</label>
          <div class="tags-input-wrap" id="upload-tags-wrap" onclick="document.getElementById('upload-tag-input').focus()">
            <input type="text" id="upload-tag-input" placeholder="Type a tag…" onkeydown="handleTagInput(event)">
          </div>

          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn-primary" onclick="saveNote()">Save Note</button>
            <button class="btn-secondary" onclick="cancelUpload()">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- SETTINGS PAGE -->
    <div id="page-settings" class="content-area page-hidden">
      <div class="page-header">
        <div class="page-title">Settings</div>
      </div>

      <div class="settings-section-title">Theme</div>
      <div class="theme-grid">
        <div class="theme-opt dark active" data-theme="dark" onclick="setTheme('dark')">Dark</div>
        <div class="theme-opt light" data-theme="light" onclick="setTheme('light')">Light</div>
        <div class="theme-opt navy" data-theme="navy" onclick="setTheme('navy')">Navy</div>
      </div>

      <div class="settings-section-title" style="margin-top:20px">Accent Color</div>
      <div class="accent-grid">
        <div class="accent-opt active" data-accent="purple" style="background:linear-gradient(135deg,#7c6dfa,#a594ff)" onclick="setAccent('purple','#7c6dfa','#a594ff','rgba(124,109,250,0.18)')"></div>
        <div class="accent-opt" data-accent="blue" style="background:linear-gradient(135deg,#3b82f6,#60a5fa)" onclick="setAccent('blue','#3b82f6','#60a5fa','rgba(59,130,246,0.15)')"></div>
        <div class="accent-opt" data-accent="green" style="background:linear-gradient(135deg,#10b981,#34d399)" onclick="setAccent('green','#10b981','#34d399','rgba(16,185,129,0.15)')"></div>
        <div class="accent-opt" data-accent="orange" style="background:linear-gradient(135deg,#f59e0b,#fbbf24)" onclick="setAccent('orange','#f59e0b','#fbbf24','rgba(245,158,11,0.15)')"></div>
      </div>

      <div class="settings-section-title" style="margin-top:24px">Offline Access</div>
      <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:16px 18px;display:flex;flex-direction:column;gap:12px;">
        <div style="font-size:0.85rem;color:var(--text2);line-height:1.5;">
          Save all your notes, folders and settings to this device so you can access them without internet.
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border);">
          <div>
            <div style="font-size:0.88rem;font-weight:700;color:var(--text);">Auto-save Offline</div>
            <div style="font-size:0.75rem;color:var(--text3);margin-top:2px;">Automatically sync to offline storage when notes change</div>
          </div>
          <label style="position:relative;display:inline-block;width:44px;height:24px;flex-shrink:0;">
            <input type="checkbox" id="offline-autosave-toggle" onchange="toggleOfflineAutosave(this.checked)" style="opacity:0;width:0;height:0;position:absolute;">
            <span id="offline-autosave-track" style="position:absolute;cursor:pointer;inset:0;background:var(--bg4);border-radius:24px;transition:0.2s;border:1px solid var(--border);"></span>
            <span id="offline-autosave-thumb" style="position:absolute;left:3px;top:3px;width:16px;height:16px;background:var(--text3);border-radius:50%;transition:0.2s;"></span>
          </label>
        </div>
        <div id="offline-status" style="font-size:0.78rem;font-family:var(--mono);color:var(--text3);min-height:16px;"></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btn-primary" onclick="downloadOffline()" id="offline-save-btn" style="flex:1;justify-content:center;gap:8px;">
            <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            Save for Offline
          </button>
          <button class="btn-secondary" onclick="clearOffline()" style="flex:1;justify-content:center;">
            Clear Offline Data
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FLOATING NOTE WINDOWS -->
<div id="floating-windows"></div>

<!-- NOTE VIEWER OVERLAY -->
<div id="note-viewer">
  <div class="note-window" id="note-window" style="width:780px;height:560px;left:50%;top:50%;transform:translate(-50%,-50%)">
    <div class="note-window-titlebar" id="note-win-titlebar">
      <span class="win-title" id="note-win-title">Note</span>
      <button class="win-btn fullscreen" onclick="toggleFullscreenWin()" title="Fullscreen">
        <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 3H5a2 2 0 00-2 2v3M16 3h3a2 2 0 012 2v3M21 16v3a2 2 0 01-2 2h-3M8 21H5a2 2 0 01-2-2v-3"/></svg>
      </button>
      <button class="win-btn close" onclick="closeNoteViewer()" title="Close">
        <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="note-window-body">
      <iframe id="note-iframe" sandbox="allow-scripts allow-same-origin"></iframe>
    </div>
    <div class="resize-handle" id="resize-handle">
      <svg viewBox="0 0 10 10" width="10" height="10" fill="none" stroke="var(--text3)" stroke-width="1.2" stroke-linecap="round"><line x1="9" y1="1" x2="1" y2="9"/><line x1="9" y1="5" x2="5" y2="9"/></svg>
    </div>
  </div>
</div>

<!-- MOBILE BOTTOM NAV -->
<div class="mobile-bottom-nav" id="mobile-bottom-nav">
  <button class="mob-nav-btn active" id="mob-nav-home" onclick="navigate('home'); navigateHome(null);" title="All Notes">
    <svg viewBox="0 0 24 24" class="dt-icon" width="22" height="22"><path class="dt-bg" d="M3 10.5L12 3l9 7.5V20a1 1 0 01-1 1H4a1 1 0 01-1-1V10.5z"/><path class="dt-stroke" d="M3 10.5L12 3l9 7.5" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path class="dt-stroke" d="M9 21v-6h6v6" fill="none" stroke-width="1.8" stroke-linecap="round"/></svg>
    <span>Home</span>
  </button>
  <button class="mob-nav-btn" id="mob-nav-upload" onclick="navigate('upload')" title="Upload">
    <svg viewBox="0 0 24 24" class="dt-icon" width="22" height="22"><rect class="dt-bg" x="3" y="15" width="18" height="6" rx="1"/><path class="dt-stroke" d="M12 3v12M7 8l5-5 5 5" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
    <span>Upload</span>
  </button>
  <button class="mob-nav-btn" id="mob-nav-settings" onclick="navigate('settings')" title="Settings">
    <svg viewBox="0 0 24 24" class="dt-icon" width="22" height="22"><circle class="dt-bg" cx="12" cy="12" r="9"/><circle class="dt-stroke-only" cx="12" cy="12" r="3" fill="none" stroke-width="1.8"/><path class="dt-stroke" d="M12 5v2M12 17v2M5 12H3M21 12h-2M7.05 7.05L5.64 5.64M18.36 18.36l-1.41-1.41M7.05 16.95l-1.41 1.41M18.36 5.64l-1.41 1.41" fill="none" stroke-width="1.8" stroke-linecap="round"/></svg>
    <span>Settings</span>
  </button>
  <button class="mob-nav-btn logout-btn" onclick="doLogout()" title="Sign out">
    <svg viewBox="0 0 24 24" class="dt-icon" width="22" height="22"><rect class="dt-bg" x="3" y="3" width="10" height="18" rx="1"/><path class="dt-stroke" d="M15 8l4 4-4 4M9 12h10" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
    <span>Logout</span>
  </button>
</div>
<!-- FOLDER CONTEXT MENU -->
<div class="folder-ctx-menu" id="folder-ctx-menu">
  <div class="ctx-item" id="ctx-rename-folder" onclick="ctxRenameFolder()">
    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
    Rename
  </div>
  <div class="ctx-item" id="ctx-change-parent" onclick="ctxChangeParent()">
    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z"/><path d="M3 8l2-4h14l2 4M9 12v6M15 12v6"/></svg>
    Change Parent Folder
  </div>
  <div class="ctx-item danger" id="ctx-delete-folder" onclick="ctxDeleteFolder()">
    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 01-2 2H8a2 2 0 01-2-2L5 6"/><path d="M10 11v6M14 11v6"/><path d="M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg>
    Delete Folder
  </div>
</div>

<!-- PROFILE PANEL -->
<div id="profile-panel">
  <div class="profile-backdrop" onclick="closeProfilePanel()"></div>
  <div class="profile-sheet">
    <div class="profile-header">
      <div class="profile-avatar-big" id="profile-avatar-big">U</div>
      <div>
        <div class="profile-name" id="profile-name-display">User</div>
        <div class="profile-email" id="profile-email-display"></div>
      </div>
      <button class="profile-close" onclick="closeProfilePanel()">✕</button>
    </div>

    <!-- Theme -->
    
    
    <div class="profile-divider"></div>
<div class="profile-section">
      <div class="profile-section-title">Theme</div>
      <div class="profile-theme-grid">
        <div class="profile-theme-opt dark" data-ptheme="dark" onclick="setTheme('dark')">Dark</div>
        <div class="profile-theme-opt light" data-ptheme="light" onclick="setTheme('light')">Light</div>
        <div class="profile-theme-opt navy" data-ptheme="navy" onclick="setTheme('navy')">Navy</div>
      </div>
    </div>
    <div class="profile-divider"></div>

    <!-- Accent Color -->
    <div class="profile-section">
      <div class="profile-section-title">Accent Color</div>
      <div class="profile-accent-grid">
        <div class="profile-accent-opt" data-paccent="purple" style="background:linear-gradient(135deg,#7c6dfa,#a594ff)" onclick="setAccent('purple')"></div>
        <div class="profile-accent-opt" data-paccent="blue" style="background:linear-gradient(135deg,#3b82f6,#60a5fa)" onclick="setAccent('blue')"></div>
        <div class="profile-accent-opt" data-paccent="green" style="background:linear-gradient(135deg,#10b981,#34d399)" onclick="setAccent('green')"></div>
        <div class="profile-accent-opt" data-paccent="orange" style="background:linear-gradient(135deg,#f59e0b,#fbbf24)" onclick="setAccent('orange')"></div>
        <div class="profile-accent-opt" data-paccent="pink" style="background:linear-gradient(135deg,#ec4899,#f472b6)" onclick="setAccent('pink')"></div>
        <div class="profile-accent-opt" data-paccent="red" style="background:linear-gradient(135deg,#ef4444,#f87171)" onclick="setAccent('red')"></div>
        <div class="profile-accent-opt" data-paccent="teal" style="background:linear-gradient(135deg,#14b8a6,#2dd4bf)" onclick="setAccent('teal')"></div>
        <div class="profile-accent-opt" data-paccent="yellow" style="background:linear-gradient(135deg,#eab308,#facc15)" onclick="setAccent('yellow')"></div>
      </div>
    </div>
    <div class="profile-divider"></div>

    <!-- Text Style -->
    <div class="profile-section">
      <div class="profile-section-title">Text Style</div>
      <div class="text-style-grid">
        <div class="text-style-opt" data-textstyle="default" onclick="setTextStyle('default')">
          <span class="text-style-preview" style="font-family:'Syne',sans-serif">The quick brown fox</span>
          <span class="text-style-label">Default — Syne</span>
        </div>
        <div class="text-style-opt" data-textstyle="mono" onclick="setTextStyle('mono')">
          <span class="text-style-preview" style="font-family:'DM Mono',monospace">The quick brown fox</span>
          <span class="text-style-label">Mono — DM Mono</span>
        </div>
        <div class="text-style-opt" data-textstyle="serif" onclick="setTextStyle('serif')">
          <span class="text-style-preview" style="font-family:Georgia,serif">The quick brown fox</span>
          <span class="text-style-label">Serif — Georgia</span>
        </div>
        <div class="text-style-opt" data-textstyle="rounded" onclick="setTextStyle('rounded')">
          <span class="text-style-preview" style="font-family:'Trebuchet MS',sans-serif">The quick brown fox</span>
          <span class="text-style-label">Rounded — Trebuchet</span>
        </div>
      </div>
    </div>
    <div class="profile-divider"></div>

    <!-- Font Size -->
    <div class="profile-section">
      <div class="profile-section-title">Font Size</div>
      <div class="font-size-row">
        <span style="font-size:0.75rem;color:var(--text3)">A</span>
        <input type="range" min="12" max="20" value="15" id="font-size-slider" oninput="setFontSize(this.value)">
        <span style="font-size:1.1rem;color:var(--text2)">A</span>
        <span class="font-size-val" id="font-size-val">15px</span>
      </div>
    </div>
    <div class="profile-divider"></div>

    <!-- Danger zone -->
    <!-- Change Picture -->
    <div class="profile-section">
      <div class="profile-section-title">Photo</div>
      <input type="file" id="profile-pic-input" accept="image/*" style="display:none" onchange="handleProfilePic(this.files)">
      <button class="btn-secondary" style="width:100%; display:flex; align-items:center; justify-content:center; gap:8px;" onclick="document.getElementById('profile-pic-input').click()">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
        Change Profile Picture
      </button>
    </div><div class="profile-section" style="padding-bottom:16px">
      <div class="profile-divider"></div>
      <div class="profile-section">
        <div class="profile-section-title">Offline Access</div>
        <div id="profile-offline-status" style="font-size:0.75rem;color:var(--text3);font-family:var(--mono);margin-bottom:10px;min-height:14px;"></div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
          <div style="font-size:0.83rem;font-weight:600;color:var(--text);">Auto-save</div>
          <label style="position:relative;display:inline-block;width:40px;height:22px;flex-shrink:0;">
            <input type="checkbox" id="profile-autosave-toggle" onchange="toggleOfflineAutosave(this.checked)" style="opacity:0;width:0;height:0;position:absolute;">
            <span id="profile-autosave-track" style="position:absolute;cursor:pointer;inset:0;background:var(--bg4);border-radius:22px;transition:0.2s;border:1px solid var(--border);"></span>
            <span id="profile-autosave-thumb" style="position:absolute;left:3px;top:3px;width:14px;height:14px;background:var(--text3);border-radius:50%;transition:0.2s;"></span>
          </label>
        </div>
        <button onclick="downloadOffline()" style="width:100%;padding:9px;border-radius:8px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-family:var(--font);font-weight:600;font-size:0.84rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;transition:all var(--transition);" onmouseover="this.style.background='var(--accent-glow)';this.style.color='var(--accent2)';this.style.borderColor='var(--accent)'" onmouseout="this.style.background='var(--bg3)';this.style.color='var(--text2)';this.style.borderColor='var(--border)'">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          Save for Offline
        </button>
      </div>
      <div class="profile-section-title">Account</div>
      <button onclick="doLogout();closeProfilePanel();" style="width:100%;padding:10px;border-radius:8px;border:1.5px solid var(--danger);background:transparent;color:var(--danger);font-family:var(--font);font-weight:700;font-size:0.88rem;cursor:pointer;transition:all var(--transition)" onmouseover="this.style.background='rgba(255,91,107,0.12)'" onmouseout="this.style.background='transparent'">
        Sign Out
      </button>
    </div>
  </div>
</div>

<!-- New Folder Modal -->
<div class="modal-overlay" id="folder-modal">
  <div class="modal">
    <h3>New Folder</h3>
    <label>Folder Name</label>
    <input type="text" id="folder-name-input" placeholder="e.g. Projects">
    <label>Parent Folder (optional)</label>
    <select id="folder-parent-select"><option value="">— Root —</option></select>
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeFolderModal()">Cancel</button>
      <button class="btn-primary" onclick="createFolder()">Create</button>
    </div>
  </div>
</div>

<!-- Rename Modal -->
<div class="modal-overlay" id="rename-modal">
  <div class="modal">
    <h3>Rename Note</h3>
    <label>New Name</label>
    <input type="text" id="rename-input" placeholder="New name">
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeRenameModal()">Cancel</button>
      <button class="btn-primary" onclick="confirmRename()">Rename</button>
    </div>
  </div>
</div>

<!-- Delete Confirm Modal -->
<div class="modal-overlay" id="delete-modal">
  <div class="modal">
    <h3>Delete Note</h3>
    <p style="color:var(--text2);font-size:0.9rem;margin-bottom:16px">Are you sure you want to delete <strong id="delete-note-name"></strong>? This cannot be undone.</p>
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeDeleteModal()">Cancel</button>
      <button class="btn-primary" style="background:var(--danger)" onclick="confirmDelete()">Delete</button>
    </div>
  </div>
</div>

<!-- Delete Folder Modal -->
<div class="modal-overlay" id="delete-folder-modal">
  <div class="modal">
    <h3>Delete Folder</h3>
    <p style="color:var(--text2);font-size:0.9rem;margin-bottom:8px">Delete <strong id="delete-folder-name"></strong>?</p>
    <p style="color:var(--text3);font-size:0.82rem;margin-bottom:16px">Notes inside will be moved to root (not deleted).</p>
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeDeleteFolderModal()">Cancel</button>
      <button class="btn-primary" style="background:var(--danger)" onclick="confirmDeleteFolder()">Delete Folder</button>
    </div>
  </div>
</div>

<!-- Rename Folder Modal -->
<div class="modal-overlay" id="rename-folder-modal">
  <div class="modal">
    <h3>Rename Folder</h3>
    <label>New Name</label>
    <input type="text" id="rename-folder-input" placeholder="Folder name">
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeRenameFolderModal()">Cancel</button>
      <button class="btn-primary" onclick="confirmRenameFolder()">Rename</button>
    </div>
  </div>
</div>

<!-- Reupload Modal -->
<div class="modal-overlay" id="reupload-modal">
  <div class="modal">
    <h3>Update Note</h3>
    <p style="color:var(--text2);font-size:0.85rem;margin-bottom:14px">Replacing: <strong id="reupload-note-name" style="color:var(--text)"></strong></p>
    <div class="reupload-zone" id="reupload-zone" onclick="document.getElementById('reupload-file-input').click()">
      <p><strong>Click or drag & drop</strong> a new HTML file</p>
      <p style="margin-top:4px;font-size:0.78rem;color:var(--text3)" id="reupload-selected-name">No file selected</p>
    </div>
    <input type="file" id="reupload-file-input" accept=".html,.htm" style="display:none" onchange="handleReuploadFile(this.files)">
    <div class="modal-actions" style="justify-content:space-between">
      <button class="btn-secondary" style="background:rgba(255,91,107,0.12);color:var(--danger);border-color:var(--danger)" onclick="deleteFromReuploadModal()">🗑 Delete Note</button>
      <div style="display:flex;gap:8px">
        <button class="btn-secondary" onclick="closeReuploadModal()">Cancel</button>
        <button class="btn-primary" id="reupload-confirm-btn" onclick="confirmReupload()" disabled style="opacity:0.5">Replace File</button>
      </div>
    </div>
  </div>
</div>

<script>

function handleProfilePic(files) {
  if (!files || !files[0]) return;
  const file = files[0];
  if (!file.type.startsWith('image/')) { showToast('Please select an image file'); return; }
  
  const reader = new FileReader();
  reader.onload = async (e) => {
    const base64 = e.target.result;
    settings.profilePic = base64;
    applySettings();
    await saveUserData();
    showToast('Profile picture updated!');
  };
  reader.readAsDataURL(file);
}

// ============================================================
// STATE & STORAGE
// ============================================================
let currentUser = null;
let notes = [];
let folders = [];
let settings = { theme: 'dark', accent: 'purple' };
let currentView = 'grid';
let activeTag = null;
let currentPage = 'home';
let uploadTags = [];
let pendingFile = null;
let renameTarget = null;
let deleteTarget = null;

// Firebase helpers (REST API - no SDK)
// ============================================================
// PERSISTENCE — localStorage primary, Firebase background sync
// ============================================================
const LS_KEY = () => `notez_data_${_fbUid}`;

function saveLocal() {
  try {
    localStorage.setItem(LS_KEY(), JSON.stringify({ notes, folders, settings }));
  } catch(e) {
    // localStorage full? try without content
    try {
      const slim = { notes: notes.map(({content,...r})=>r), folders, settings };
      localStorage.setItem(LS_KEY(), JSON.stringify(slim));
    } catch(e2) { console.warn('localStorage full', e2); }
  }
}

function loadLocal() {
  try {
    const raw = localStorage.getItem(LS_KEY());
    if (!raw) return false;
    const d = JSON.parse(raw);
    notes = d.notes || [];
    folders = d.folders || [];
    settings = d.settings || { theme:'dark', accent:'purple' };
    return true;
  } catch(e) { return false; }
}

// Firebase sync — runs in background, non-blocking
async function syncToFirebase() {
  if (!_fbUid) return;
  try {
    const token = await _getToken();
    if (!token) return;
    // Save metadata (no content — content saved per-note)
    const meta = { notes: notes.map(({content,...r})=>r), folders, settings };
    await fetch(`${FB_DB_URL}/users/${_fbUid}/meta.json?auth=${token}`, {
      method: 'PUT', headers: {'Content-Type':'application/json'},
      body: JSON.stringify(meta)
    });
    // Save each note's content
    await Promise.all(notes.map(n =>
      fetch(`${FB_DB_URL}/users/${_fbUid}/contents/${n.id}.json?auth=${token}`, {
        method: 'PUT', headers: {'Content-Type':'application/json'},
        body: JSON.stringify(n.content || '')
      })
    ));
  } catch(e) { console.log('Firebase sync skipped:', e.message); }
}

async function loadFromFirebase() {
  try {
    const token = await _getToken();
    if (!token) return false;
    const r = await fetch(`${FB_DB_URL}/users/${_fbUid}/meta.json?auth=${token}`);
    const meta = await r.json();
    if (!meta || meta.error) return false;

    const noteMeta = meta.notes || [];
    folders = meta.folders || [];
    settings = meta.settings || { theme:'dark', accent:'purple' };

    // Load content for each note
    const loaded = await Promise.all(noteMeta.map(async nm => {
      try {
        const cr = await fetch(`${FB_DB_URL}/users/${_fbUid}/contents/${nm.id}.json?auth=${token}`);
        const content = await cr.json();
        return { ...nm, content: content || '' };
      } catch(e) { return { ...nm, content: '' }; }
    }));
    notes = loaded;
    return true;
  } catch(e) { return false; }
}

// Main save — always save locally first (instant), then sync to Firebase
async function saveUserData() {
  saveLocal();
  syncToFirebase(); // fire-and-forget
  scheduleOfflineAutosave(); // autosave offline if enabled
}

async function loadUserDataFromFirebase() {
  // Try Firebase first (has full history across devices)
  const fbOk = await loadFromFirebase();
  if (fbOk) {
    saveLocal(); // cache locally
    return;
  }
  // Fall back to localStorage
  loadLocal();
}

// ============================================================
// LOGIN / AUTH (Firebase REST)
// ============================================================
function switchLoginTab(tab) {
  document.getElementById('tab-login').classList.toggle('active', tab==='login');
  document.getElementById('tab-signup').classList.toggle('active', tab==='signup');
  document.getElementById('login-form').style.display = tab==='login' ? '' : 'none';
  document.getElementById('signup-form').style.display = tab==='signup' ? '' : 'none';
}

async function doLogin() {
  const email = document.getElementById('login-username').value.trim();
  const p = document.getElementById('login-password').value;
  const err = document.getElementById('login-err');
  if (!email || !p) { err.textContent = 'Please fill in all fields.'; return; }
  const loginEmail = email.includes('@') ? email : email + '@notez.app';
  try {
    const user = await fbSignIn(loginEmail, p);
    await loginSuccess(user);
  } catch(e) {
    err.textContent = e.message.includes('INVALID_LOGIN_CREDENTIALS') || e.message.includes('INVALID_PASSWORD') || e.message.includes('EMAIL_NOT_FOUND') ? 'Invalid username or password.' : e.message;
  }
}

async function doSignup() {
  const u = document.getElementById('signup-username').value.trim();
  const emailInput = document.getElementById('signup-email').value.trim();
  const p = document.getElementById('signup-password').value;
  const c = document.getElementById('signup-confirm').value;
  const err = document.getElementById('signup-err');
  if (!u || !p) { err.textContent = 'Username and password are required.'; return; }
  if (p !== c) { err.textContent = 'Passwords do not match.'; return; }
  if (p.length < 6) { err.textContent = 'Password must be at least 6 characters.'; return; }
  const loginEmail = emailInput || (u + '@notez.app');
  try {
    const user = await fbSignUp(loginEmail, p, u);
    await loginSuccess(user);
  } catch(e) {
    err.textContent = e.message.includes('EMAIL_EXISTS') ? 'Username already taken.' : e.message;
  }
}

async function loginSuccess(user) {
  currentUser = user.uid;
  _fbUid = user.uid;
  const displayName = user.displayName || 'User';
  await loadUserDataFromFirebase();
  document.getElementById('login-screen').style.display = 'none';
  document.getElementById('app').style.display = 'flex';
  document.getElementById('user-avatar-text').textContent = displayName[0].toUpperCase();
  document.getElementById('user-avatar-text').title = displayName;
  applySettings();
  renderAll();
}

async function doLogout() {
  fbSignOut();
  currentUser = null;
  _fbUid = null;
  notes = []; folders = []; settings = { theme:'dark', accent:'purple' };
  document.getElementById('login-screen').style.display = 'flex';
  document.getElementById('app').style.display = 'none';
}

function getUserData() { return { notes, folders, settings }; }

// Setup runs from Firebase init block at bottom of body

// ============================================================
// SETTINGS / THEMES
// ============================================================
const ACCENTS = {
  purple: ['#7c6dfa','#a594ff','rgba(124,109,250,0.18)'],
  blue:   ['#3b82f6','#60a5fa','rgba(59,130,246,0.15)'],
  green:  ['#10b981','#34d399','rgba(16,185,129,0.15)'],
  orange: ['#f59e0b','#fbbf24','rgba(245,158,11,0.15)'],
  pink:   ['#ec4899','#f472b6','rgba(236,72,153,0.15)'],
  red:    ['#ef4444','#f87171','rgba(239,68,68,0.15)'],
  teal:   ['#14b8a6','#2dd4bf','rgba(20,184,166,0.15)'],
  yellow: ['#eab308','#facc15','rgba(234,179,8,0.15)'],
};
const TEXT_STYLES = {
  default: { font: "'Syne', sans-serif" },
  mono:    { font: "'DM Mono', monospace" },
  serif:   { font: "Georgia, 'Times New Roman', serif" },
  rounded: { font: "'Trebuchet MS', 'Arial Rounded MT Bold', sans-serif" },
};

function applySettings() {
  // Update Names and Avatars
  const displayName = _fbDisplayName || 'User';
  const initial = displayName[0].toUpperCase();
  
  const nameEls = ['sb-username', 'profile-name-display'];
  nameEls.forEach(id => {
    const el = document.getElementById(id);
    if(el) el.textContent = displayName;
  });
  
  const avatarText = document.getElementById('user-avatar-text');
  if(avatarText) avatarText.textContent = initial;

  const avatars = ['sb-avatar', 'profile-avatar-big'];
  avatars.forEach(id => {
    const el = document.getElementById(id);
    if(el) {
      if(settings.profilePic) {
        el.innerHTML = `<img src="${settings.profilePic}" style="width:100%;height:100%;object-fit:cover;">`;
        el.style.background = 'transparent';
      } else {
        el.textContent = initial;
        el.style.background = 'var(--accent)';
      }
    }
  });

  document.documentElement.setAttribute('data-theme', settings.theme || 'dark');
  const acc = ACCENTS[settings.accent] || ACCENTS.purple;
  document.documentElement.style.setProperty('--accent', acc[0]);
  document.documentElement.style.setProperty('--accent2', acc[1]);
  document.documentElement.style.setProperty('--accent-glow', acc[2]);
  const tcm = document.getElementById('theme-color-meta');
  if (tcm) tcm.setAttribute('content', acc[0]);
  document.documentElement.style.setProperty('background', acc[0]);

  // Text style
  const ts = TEXT_STYLES[settings.textStyle] || TEXT_STYLES.default;
  document.documentElement.style.setProperty('--font', ts.font);

  // Font size
  if (settings.fontSize) {
    document.documentElement.style.setProperty('font-size', settings.fontSize + 'px');
  }

  // Sync all theme/accent/text opt UI
  document.querySelectorAll('.theme-opt').forEach(el => el.classList.toggle('active', el.dataset.theme===settings.theme));
  document.querySelectorAll('.accent-opt').forEach(el => el.classList.toggle('active', el.dataset.accent===settings.accent));
  document.querySelectorAll('.profile-theme-opt').forEach(el => el.classList.toggle('active', el.dataset.ptheme===settings.theme));
  document.querySelectorAll('.profile-accent-opt').forEach(el => el.classList.toggle('active', el.dataset.paccent===settings.accent));
  document.querySelectorAll('.text-style-opt').forEach(el => el.classList.toggle('active', el.dataset.textstyle===(settings.textStyle||'default')));

  // Font size slider
  const slider = document.getElementById('font-size-slider');
  const val = document.getElementById('font-size-val');
  if (slider && settings.fontSize) { slider.value = settings.fontSize; }
  if (val && settings.fontSize) { val.textContent = settings.fontSize + 'px'; }
  // Update sidebar logo filter based on accent
  const logoIcon = document.getElementById('sidebar-logo-icon');
  if (logoIcon) {
    const filterMap = {
      purple: 'hue-rotate(60deg) saturate(1.2)',
      blue:   'hue-rotate(0deg) saturate(1)',
      green:  'hue-rotate(-50deg) saturate(1.3)',
      orange: 'hue-rotate(-170deg) saturate(1.4)'
    };
    logoIcon.style.filter = filterMap[settings.accent] || filterMap.purple;
  }
}

function setTheme(t) { settings.theme = t; saveSettings(); applySettings(); }
function setAccent(name) { settings.accent = name; saveSettings(); applySettings(); }
function setTextStyle(style) { settings.textStyle = style; saveSettings(); applySettings(); }
function setFontSize(size) {
  settings.fontSize = parseInt(size);
  document.documentElement.style.setProperty('font-size', size + 'px');
  const val = document.getElementById('font-size-val');
  if (val) val.textContent = size + 'px';
  saveSettings();
}
async function saveSettings() {
  if (!currentUser) return;
  await saveUserData();
}

// ============================================================
// PROFILE PANEL
// ============================================================
function openProfilePanel() {
  checkOfflineStatus();
  _offlineAutosaveEnabled = localStorage.getItem('notez_offline_autosave') === '1';
  updateAutosaveToggleUI(_offlineAutosaveEnabled);
  pushState();
  const displayName = _fbDisplayName || 'User';
  const email = _fbDisplayName ? (_fbDisplayName + '@notez.app') : '';
  document.getElementById('profile-avatar-big').textContent = displayName[0].toUpperCase();
  document.getElementById('profile-name-display').textContent = displayName;
  document.getElementById('profile-email-display').textContent = email;
  // Sync slider
  const slider = document.getElementById('font-size-slider');
  const val = document.getElementById('font-size-val');
  if (slider) slider.value = settings.fontSize || 15;
  if (val) val.textContent = (settings.fontSize || 15) + 'px';
  applySettings();
  document.getElementById('profile-panel').classList.add('open');
}
function closeProfilePanel() {
  document.getElementById('profile-panel').classList.remove('open');
}

// ============================================================
// FOLDER CONTEXT MENU
// ============================================================
let ctxFolderId = null;
function openFolderCtxMenu(e, folderId) {
  e.preventDefault(); e.stopPropagation();
  ctxFolderId = folderId;
  const menu = document.getElementById('folder-ctx-menu');
  menu.classList.add('open');
  // Position near cursor, keep in viewport
  const x = Math.min(e.clientX, window.innerWidth - 160);
  const y = Math.min(e.clientY, window.innerHeight - 90);
  menu.style.left = x + 'px';
  menu.style.top = y + 'px';
}
function closeFolderCtxMenu() {
  document.getElementById('folder-ctx-menu').classList.remove('open');
  ctxFolderId = null;
}
document.addEventListener('click', () => closeFolderCtxMenu());
document.addEventListener('keydown', e => { if(e.key==='Escape') closeFolderCtxMenu(); });

function ctxRenameFolder() {
  const f = folders.find(x => x.id === ctxFolderId);
  if (!f) return;
  document.getElementById('rename-folder-input').value = f.name;
  document.getElementById('rename-folder-modal').classList.add('open');
  setTimeout(() => document.getElementById('rename-folder-input').focus(), 50);
  closeFolderCtxMenu();
}
function closeRenameFolderModal() { document.getElementById('rename-folder-modal').classList.remove('open'); }
async function confirmRenameFolder() {
  const val = document.getElementById('rename-folder-input').value.trim();
  if (!val || !ctxFolderId) return;
  // ctxFolderId might be cleared — store it
  const fid = document.getElementById('rename-folder-input').dataset.fid || ctxFolderId;
  const f = folders.find(x => x.id === fid);
  if (f) { f.name = val; await saveUserData(); renderAll(); showToast('Folder renamed!'); }
  closeRenameFolderModal();
}

let deleteFolderTarget = null;
function ctxDeleteFolder() {
  deleteFolderTarget = ctxFolderId;
  const f = folders.find(x => x.id === deleteFolderTarget);
  if (!f) return;
  document.getElementById('delete-folder-name').textContent = f.name;
  document.getElementById('delete-folder-modal').classList.add('open');
  closeFolderCtxMenu();
}
function closeDeleteFolderModal() {
  document.getElementById('delete-folder-modal').classList.remove('open');
  deleteFolderTarget = null;
}
async function confirmDeleteFolder() {
  if (!deleteFolderTarget) return;
  // Move notes in this folder to root
  notes.forEach(n => { if (n.folder === deleteFolderTarget) n.folder = null; });
  // Also remove child folders recursively
  function removeFolder(fid) {
    const children = folders.filter(f => f.parent === fid);
    children.forEach(c => removeFolder(c.id));
    folders = folders.filter(f => f.id !== fid);
  }
  removeFolder(deleteFolderTarget);
  await saveUserData();
  closeDeleteFolderModal();
  renderAll();
  showToast('Folder deleted!');
}

function ctxChangeParent() {
  const fid = ctxFolderId;
  if (!fid) return;
  const folder = folders.find(f => f.id === fid);
  if (!folder) return;
  
  const allFolders = folders.filter(f => f.id !== fid);
  
  const modal = document.createElement('div');
  modal.id = 'parent-select-modal';
  modal.style.cssText = 'position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;pointer-events:auto;';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  const content = document.createElement('div');
  content.style.cssText = 'background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;max-width:400px;width:90%;max-height:70vh;overflow-y:auto;pointer-events:auto;';
  
  const title = document.createElement('div');
  title.style.cssText = 'font-weight:700;margin-bottom:16px;font-size:1rem;color:var(--text);';
  title.textContent = `Select Parent Folder for "${folder.name}"`;
  content.appendChild(title);
  
  // Root option
  const rootBtn = document.createElement('div');
  rootBtn.style.cssText = 'padding:12px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;margin-bottom:8px;user-select:none;pointer-events:auto;';
  rootBtn.textContent = '📁 Root (No parent)';
  rootBtn.onclick = (e) => { e.stopPropagation(); setFolderParentFromId(fid, null); modal.remove(); };
  rootBtn.onmouseover = () => { rootBtn.style.background = 'var(--bg4)'; };
  rootBtn.onmouseout = () => { rootBtn.style.background = 'var(--bg3)'; };
  content.appendChild(rootBtn);
  
  // Folder options
  allFolders.forEach(f => {
    const btn = document.createElement('div');
    btn.style.cssText = 'padding:12px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;margin-bottom:8px;user-select:none;pointer-events:auto;';
    btn.textContent = '📁 ' + f.name;
    btn.onclick = (e) => { e.stopPropagation(); setFolderParentFromId(fid, f.id); modal.remove(); };
    btn.onmouseover = () => { btn.style.background = 'var(--bg4)'; };
    btn.onmouseout = () => { btn.style.background = 'var(--bg3)'; };
    content.appendChild(btn);
  });
  
  const cancelBtn = document.createElement('div');
  cancelBtn.style.cssText = 'width:100%;padding:10px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;color:var(--text);font-family:var(--font);font-weight:600;transition:all 0.18s;text-align:center;user-select:none;pointer-events:auto;';
  cancelBtn.textContent = 'Cancel';
  cancelBtn.onclick = () => modal.remove();
  cancelBtn.onmouseover = () => { cancelBtn.style.background = 'var(--bg4)'; };
  cancelBtn.onmouseout = () => { cancelBtn.style.background = 'var(--bg3)'; };
  content.appendChild(cancelBtn);
  
  modal.appendChild(content);
  document.body.appendChild(modal);
  closeFolderCtxMenu();
}

function setFolderParentFromId(id, parentId) {
  const f = folders.find(f => f.id === id);
  if (f) { f.parent = parentId; saveUserData(); renderAll(); showToast("Parent updated!"); }
}
function setFolderParent(parentId) {
  if (!ctxFolderId) return;
  const folder = folders.find(f => f.id === fid);
  if (!folder) return;
  folder.parent = parentId || null;
  saveUserData();
  renderAll();
  showToast('Parent folder changed!');
  const modal = document.getElementById('parent-select-modal');
  if (modal) modal.remove();
}

// Note context menu
function openUpdateWindow(noteId) {
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  // Create floating window
  const windowId = 'update-window-' + noteId;
  const existingWindow = document.getElementById(windowId);
  if (existingWindow) {
    existingWindow.remove();
    return;
  }
  
  const container = document.querySelector('#floating-windows') || document.body;
  const updateWindow = document.createElement('div');
  updateWindow.id = windowId;
  updateWindow.className = 'update-window';
  updateWindow.style.left = (100 + Math.random() * 200) + 'px';
  updateWindow.style.top = (100 + Math.random() * 200) + 'px';
  
  const renameBtn = document.createElement('button');
  renameBtn.className = 'update-window-btn';
  renameBtn.textContent = '📝 Rename Note';
  renameBtn.onclick = () => {
    openRenameModal(noteId);
    updateWindow.remove();
  };
  
  const replaceBtn = document.createElement('button');
  replaceBtn.className = 'update-window-btn';
  replaceBtn.textContent = '📤 Replace File';
  replaceBtn.onclick = () => {
    openReuploadModal(noteId);
    updateWindow.remove();
  };
  
  const changeParentBtn = document.createElement('button');
  changeParentBtn.className = 'update-window-btn';
  changeParentBtn.textContent = '📁 Change Parent Folder';
  changeParentBtn.onclick = () => {
    openNoteParentModal(noteId);
    updateWindow.remove();
  };
  
  const closeBtn = document.createElement('button');
  closeBtn.className = 'update-window-btn';
  closeBtn.style.background = 'var(--bg3)';
  closeBtn.style.color = 'var(--text3)';
  closeBtn.style.cursor = 'pointer';
  closeBtn.textContent = '✕ Close';
  closeBtn.onclick = () => updateWindow.remove();
  
  const title = document.createElement('div');
  title.className = 'update-window-title';
  title.textContent = 'Update: ' + note.name;
  
  updateWindow.appendChild(title);
  updateWindow.appendChild(renameBtn);
  updateWindow.appendChild(replaceBtn);
  updateWindow.appendChild(changeParentBtn);
  updateWindow.appendChild(closeBtn);
  
  container.appendChild(updateWindow);
  makeDraggable(windowId);
}

let ctxNoteIdForParent = null;

function openNoteParentModal(noteId) {
  const nid = noteId; ctxNoteIdForParent = noteId;
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  const allFolders = folders;
  
  const modal = document.createElement('div');
  modal.id = 'note-parent-select-modal';
  modal.style.cssText = 'position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;pointer-events:auto;';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  const content = document.createElement('div');
  content.style.cssText = 'background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;max-width:400px;width:90%;max-height:70vh;overflow-y:auto;pointer-events:auto;';
  
  const title = document.createElement('div');
  title.style.cssText = 'font-weight:700;margin-bottom:16px;font-size:1rem;color:var(--text);';
  title.textContent = `Select Folder for "${note.name}"`;
  content.appendChild(title);
  
  // Root option
  const rootBtn = document.createElement('div');
  rootBtn.style.cssText = 'padding:12px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;margin-bottom:8px;user-select:none;pointer-events:auto;';
  rootBtn.textContent = '📁 Root (No folder)';
  rootBtn.onclick = (e) => { e.stopPropagation(); setNoteParentFromId(nid, null); modal.remove(); };
  rootBtn.onmouseover = () => { rootBtn.style.background = 'var(--bg4)'; };
  rootBtn.onmouseout = () => { rootBtn.style.background = 'var(--bg3)'; };
  content.appendChild(rootBtn);
  
  // Folder options
  allFolders.forEach(f => {
    const btn = document.createElement('div');
    btn.style.cssText = 'padding:12px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;margin-bottom:8px;user-select:none;pointer-events:auto;';
    btn.textContent = '📁 ' + f.name;
    btn.onclick = (e) => { e.stopPropagation(); setNoteParentFromId(nid, f.id); modal.remove(); };
    btn.onmouseover = () => { btn.style.background = 'var(--bg4)'; };
    btn.onmouseout = () => { btn.style.background = 'var(--bg3)'; };
    content.appendChild(btn);
  });
  
  const cancelBtn = document.createElement('div');
  cancelBtn.style.cssText = 'width:100%;padding:10px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;color:var(--text);font-family:var(--font);font-weight:600;transition:all 0.18s;text-align:center;user-select:none;pointer-events:auto;';
  cancelBtn.textContent = 'Cancel';
  cancelBtn.onclick = () => modal.remove();
  cancelBtn.onmouseover = () => { cancelBtn.style.background = 'var(--bg4)'; };
  cancelBtn.onmouseout = () => { cancelBtn.style.background = 'var(--bg3)'; };
  content.appendChild(cancelBtn);
  
  modal.appendChild(content);
  document.body.appendChild(modal);
}

function setNoteParentFromId(id, folderId) {
  const node = notes.find(n => n.id === id);
  if (node) { node.folder = folderId; saveUserData(); renderAll(); showToast("Folder updated!"); }
}
function setNoteParent(folderId) {
  if (!ctxNoteIdForParent) return;
  const note = notes.find(n => n.id === ctxNoteIdForParent);
  if (!note) return;
  note.folder = folderId || null;
  saveUserData();
  renderAll();
  showToast('Note folder changed!');
  const modal = document.getElementById('note-parent-select-modal');
  if (modal) modal.remove();
}
function openNoteCtxMenu(e, noteId) {
  e.preventDefault(); e.stopPropagation();
  ctxNoteId = noteId;
  
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  // Create context menu for note
  const menu = document.createElement('div');
  menu.className = 'folder-ctx-menu open';
  menu.id = 'note-ctx-menu';
  menu.style.zIndex = '300';
  
  let html = `
    <div class="ctx-item" onclick="ctxChangeNoteParent()">
      <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z"/><path d="M3 8l3-5h5l2 3h8a1 1 0 011 1M9 12v6M15 12v6"/></svg>
      Change Folder
    </div>
  `;
  
  menu.innerHTML = html;
  document.body.appendChild(menu);
  
  const x = Math.min(e.clientX, window.innerWidth - 160);
  const y = Math.min(e.clientY, window.innerHeight - 90);
  menu.style.left = x + 'px';
  menu.style.top = y + 'px';
  
  setTimeout(() => {
    document.addEventListener('click', closeNoteCtxMenu);
  }, 0);
}

function closeNoteCtxMenu() {
  const menu = document.getElementById('note-ctx-menu');
  if (menu) menu.remove();
  ctxNoteId = null;
  document.removeEventListener('click', closeNoteCtxMenu);
}

function ctxChangeNoteParent() {
  const nid = ctxNoteId;
  if (!nid) return;
  const note = notes.find(n => n.id === ctxNoteId);
  if (!note) return;
  
  const modal = document.createElement('div');
  modal.id = 'note-parent-select-modal';
  modal.style.cssText = 'position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;pointer-events:auto;';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  const content = document.createElement('div');
  content.style.cssText = 'background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;max-width:400px;width:90%;';
  
  const title = document.createElement('div');
  title.style.cssText = 'font-weight:700;margin-bottom:16px;font-size:1rem;color:var(--text);';
  title.textContent = `Select Folder for "${note.name}"`;
  
  const optionsDiv = document.createElement('div');
  optionsDiv.style.cssText = 'max-height:300px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;margin-bottom:16px;';
  
  // Folder options
  folders.forEach(f => {
    const isSelected = f.id === note.folder;
    const btn = document.createElement('button');
    btn.style.cssText = `padding:12px;background:${isSelected ? 'var(--accent-glow)' : 'var(--bg3)'};border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;`;
    btn.textContent = f.name;
    btn.dataset.folderId = f.id;
    btn.dataset.isSelected = isSelected;
    btn.onclick = (e) => { e.stopPropagation(); setNoteParentFromId(nid, f.id); modal.remove(); };
    btn.onmouseover = () => { btn.style.background = 'var(--bg4)'; };
    btn.onmouseout = () => { btn.style.background = btn.dataset.isSelected === 'true' ? 'var(--accent-glow)' : 'var(--bg3)'; };
    optionsDiv.appendChild(btn);
  });
  
  const cancelBtn = document.createElement('button');
  cancelBtn.style.cssText = 'width:100%;padding:10px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;color:var(--text);font-family:var(--font);font-weight:600;transition:all 0.18s;';
  cancelBtn.textContent = 'Cancel';
  cancelBtn.onclick = () => modal.remove();
  cancelBtn.onmouseover = () => { cancelBtn.style.background = 'var(--bg4)'; };
  cancelBtn.onmouseout = () => { cancelBtn.style.background = 'var(--bg3)'; };
  
  content.appendChild(title);
  content.appendChild(optionsDiv);
  content.appendChild(cancelBtn);
  modal.appendChild(content);
  document.body.appendChild(modal);
  closeNoteCtxMenu();
}

function setNoteParentFromId(id, folderId) {
  const node = notes.find(n => n.id === id);
  if (node) { node.folder = folderId; saveUserData(); renderAll(); showToast("Folder updated!"); }
}
function setNoteParent(folderId) {
  if (!ctxNoteId) return;
  const note = notes.find(n => n.id === ctxNoteId);
  if (!note) return;
  note.folder = folderId;
  saveUserData();
  renderAll();
  showToast('Folder changed!');
  const modal = document.getElementById('note-parent-select-modal');
  if (modal) modal.remove();
}
function navigate(page) {
  currentPage = page;
  if (page === 'home') homeFolderId = null;
  if (page === 'settings') {
    checkOfflineStatus();
    _offlineAutosaveEnabled = localStorage.getItem('notez_offline_autosave') === '1';
    updateAutosaveToggleUI(_offlineAutosaveEnabled);
  }
  ['home','upload','settings'].forEach(p => {
    document.getElementById('page-'+p).classList.toggle('page-hidden', p!==page);
    const nb = document.getElementById('nav-'+p);
    if (nb) nb.classList.toggle('active', p===page);
    const mob = document.getElementById('mob-nav-'+p);
    if (mob) mob.classList.toggle('active', p===page);
  });
  const titles = { home:'All Notes', upload:'Upload Note', settings:'Settings' };
  document.getElementById('topbar-title').textContent = titles[page] || '';
  document.getElementById('view-toggle').style.display = page==='home' ? '' : 'none';
  if (window.innerWidth <= 700) closeMobileSidebar();
}


// ============================================================
// SIDEBAR
// ============================================================
let sidebarCollapsed = false;
function old_toggleSidebar() {
  if (window.innerWidth <= 700) {
    document.getElementById('sidebar').classList.toggle('mobile-open');
    document.getElementById('mobile-overlay').classList.toggle('open');
  } else {
    sidebarCollapsed = !sidebarCollapsed;
    document.getElementById('sidebar').classList.toggle('collapsed', sidebarCollapsed);
  }
}
function old_closeMobileSidebar() {
  document.getElementById('sidebar').classList.remove('mobile-open');
  document.getElementById('mobile-overlay').classList.remove('open');
}

// ============================================================
// FOLDERS
// ============================================================
function openNewFolderModal() {
  renderFolderOptions('folder-parent-select', true);
  document.getElementById('folder-name-input').value = '';
  document.getElementById('folder-modal').classList.add('open');
  setTimeout(() => document.getElementById('folder-name-input').focus(), 50);
}
function closeFolderModal() { document.getElementById('folder-modal').classList.remove('open'); }
async function createFolder() {
  const name = document.getElementById('folder-name-input').value.trim();
  if (!name) return;
  const parent = document.getElementById('folder-parent-select').value;
  const id = 'f_' + Date.now();
  folders.push({ id, name, parent: parent || null });
  await saveUserData();
  closeFolderModal();
  renderFolderTree();
  renderFolderOptions('upload-folder');
  showToast('Folder created!');
}

function renderFolderOptions(selectId, withRoot=false) {
  const sel = document.getElementById(selectId);
  if (!sel) return;
  
  // Clear any existing options
  sel.innerHTML = '';
  
  // For uploads, the default choice is Root
  const defaultOpt = document.createElement('option');
  defaultOpt.value = "";
  if (selectId === 'upload-folder') {
      defaultOpt.textContent = "📁 Root (No folder)";
      sel.appendChild(defaultOpt);
  } else {
      defaultOpt.textContent = withRoot ? "— Root —" : "— No folder —";
      sel.appendChild(defaultOpt);
  }
  
  function addOpts(parentId, depth) {
    // Filter folders where parent matches parentId (handling null/undefined/empty string as Root)
    folders.filter(f => {
        const p = f.parent || null;
        const target = parentId || null;
        return p === target;
    }).forEach(f => {
      const opt = document.createElement('option');
      opt.value = f.id;
      // Use non-breaking spaces for visual hierarchy in standard select
      opt.textContent = "\u00A0\u00A0".repeat(depth) + (depth > 0 ? "└ " : "📁 ") + f.name;
      sel.appendChild(opt);
      addOpts(f.id, depth + 1);
    });
  }
  addOpts(null, 0);
}

function renderFolderTree() {
  const container = document.getElementById('folder-tree');
  container.innerHTML = '';

  // Root drop zone (unfiled)
  const rootDrop = document.createElement('div');
  rootDrop.className = 'folder-header';
  rootDrop.style.cssText = 'padding-left:14px;color:var(--text3);font-size:0.82rem;border:1px dashed transparent;transition:all 0.18s;';
  rootDrop.innerHTML = `<svg viewBox="0 0 24 24" width="14" height="14" style="flex-shrink:0;opacity:0.5"><path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z" fill="var(--text3)" opacity="0.18"/><path d="M3 8l3-5h5l2 3h8a1 1 0 011 1" fill="none" stroke="var(--text3)" stroke-width="1.7" stroke-linecap="round"/></svg><span style="margin-left:4px">Drop here (no folder)</span>`;
  rootDrop.style.display = 'none';
  rootDrop.id = 'root-drop-zone';
  setupFolderDropTarget(rootDrop, null);
  container.appendChild(rootDrop);

  function buildTree(parentId, targetEl, depth) {
    const children = folders.filter(f => (f.parent || null) === (parentId || null));
    children.forEach(f => {
      const notesInFolder = notes.filter(n => n.folder === f.id);
      const hasSubfolders = folders.some(sf => sf.parent === f.id);
      const hasChildren = notesInFolder.length > 0 || hasSubfolders;
      const indent = depth * 12;

      const div = document.createElement('div');
      div.className = 'folder-item';

      const header = document.createElement('div');
      header.className = 'folder-header';
      header.style.paddingLeft = (14 + indent) + 'px';
      const folderSVG = `<svg viewBox="0 0 24 24" width="15" height="15" style="flex-shrink:0"><path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z" fill="var(--accent)" opacity="0.18"/><path d="M3 8l3-5h5l2 3h8a1 1 0 011 1" fill="none" stroke="var(--accent2)" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
      const noteSVG = `<svg viewBox="0 0 24 24" width="13" height="13" style="flex-shrink:0;opacity:0.6"><path d="M6 2h9l5 5v15a1 1 0 01-1 1H5a1 1 0 01-1-1V3a1 1 0 011-1z" fill="var(--text3)" opacity="0.5"/><path d="M14 2v6h6" fill="none" stroke="var(--text3)" stroke-width="1.8" stroke-linecap="round"/></svg>`;
      header.innerHTML = `
        <span class="folder-arrow" style="${!hasChildren ? 'opacity:0.2;' : ''}">▶</span>
        ${folderSVG}
        <span>${f.name}</span>
        <span style="margin-left:auto;font-size:0.72rem;color:var(--text3)">${notesInFolder.length}</span>
      `;

      // Right-click / long-press for context menu
      header.addEventListener('contextmenu', e => openFolderCtxMenu(e, f.id));
      header.addEventListener('click', e => {
        // Store folderId for rename modal
        document.getElementById('rename-folder-input').dataset.fid = f.id;
      });

      // Make folder header a drop target
      setupFolderDropTarget(header, f.id);

      const childrenEl = document.createElement('div');
      childrenEl.className = 'folder-children';
      childrenEl.id = 'fc_' + f.id;

      notesInFolder.forEach(n => {
        const noteEl = document.createElement('div');
        noteEl.className = 'folder-note-item';
        noteEl.id = 'sfn_' + n.id;
        noteEl.draggable = true;
        noteEl.dataset.noteId = n.id;
        noteEl.style.paddingLeft = (14 + indent + 12) + 'px';
        noteEl.innerHTML = `${noteSVG} ${n.name}`;
        noteEl.onclick = () => { openNote(n.id); if(window.innerWidth<=700) closeMobileSidebar(); };
        
        // Right-click context menu for notes
        noteEl.addEventListener('contextmenu', e => openNoteCtxMenu(e, n.id));
        
        // Drag events
        noteEl.ondragstart = (e) => {
          noteEl.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/note-id', n.id);
        };
        noteEl.ondragend = (e) => {
          noteEl.classList.remove('dragging');
          document.querySelectorAll('.folder-header.drag-over').forEach(el => el.classList.remove('drag-over'));
        };
        
        childrenEl.appendChild(noteEl);
      });

      buildTree(f.id, childrenEl, depth + 1);

      header.addEventListener('click', e => {
        document.getElementById('rename-folder-input').dataset.fid = f.id;
        // Navigate home to this folder
        if (!header._dragging) {
          navigate('home');
          navigateHome(f.id);
        }
        if (!hasChildren) return;
        const arrow = header.querySelector('.folder-arrow');
        const isOpen = arrow.classList.toggle('open');
        childrenEl.classList.toggle('open', isOpen);
      });
      
      // Drop handler for moving notes to this folder
      header.ondragover = (e) => {
        if (e.dataTransfer.types.includes('text/note-id')) {
          e.preventDefault();
          e.dataTransfer.dropEffect = 'move';
          header.classList.add('drag-over');
        }
      };
      header.ondragleave = () => {
        header.classList.remove('drag-over');
      };
      header.ondrop = (e) => {
        if (e.dataTransfer.types.includes('text/note-id')) {
          e.preventDefault();
          const noteId = e.dataTransfer.getData('text/note-id');
          const note = notes.find(n => n.id === noteId);
          if (note) {
            note.folder = f.id;
            saveUserData();
            renderAll();
            showToast('Note moved to folder');
          }
        }
        header.classList.remove('drag-over');
      };

      div.appendChild(header);
      div.appendChild(childrenEl);
      targetEl.appendChild(div);
    });
  }

  buildTree(null, container, 0);

  // Add Root Notes section at the bottom of the tree
  const rootNotes = notes.filter(n => !n.folder);
  if (rootNotes.length > 0) {
    const rootHeader = document.createElement('div');
    rootHeader.className = 'sidebar-section';
    rootHeader.style.marginTop = '15px';
    rootHeader.textContent = 'Root Notes';
    container.appendChild(rootHeader);

    const noteSVG = `<svg viewBox="0 0 24 24" width="13" height="13" style="flex-shrink:0;opacity:0.6"><path d="M6 2h9l5 5v15a1 1 0 01-1 1H5a1 1 0 01-1-1V3a1 1 0 011-1z" fill="var(--text3)" opacity="0.5"/><path d="M14 2v6h6" fill="none" stroke="var(--text3)" stroke-width="1.8" stroke-linecap="round"/></svg>`;

    rootNotes.forEach(n => {
      const noteEl = document.createElement('div');
      noteEl.className = 'folder-note-item';
      noteEl.id = 'sfn_' + n.id;
      noteEl.draggable = true;
      noteEl.dataset.noteId = n.id;
      noteEl.style.paddingLeft = '14px';
      noteEl.innerHTML = `${noteSVG} ${n.name}`;
      noteEl.onclick = () => openNote(n.id);
      noteEl.addEventListener('contextmenu', e => openNoteCtxMenu(e, n.id));
      container.appendChild(noteEl);
    });
  }
}

function setupFolderDropTarget(el, folderId) {
  el.addEventListener('dragenter', e => {
    if (!e.dataTransfer.types.includes('Files')) return;
    e.preventDefault();
    el.classList.add('drag-over');
    el._dragging = true;
    // Show root drop zone if dragging over sidebar
    const rdz = document.getElementById('root-drop-zone');
    if (rdz && folderId !== null) rdz.style.display = 'flex';
  });
  el.addEventListener('dragover', e => {
    if (!e.dataTransfer.types.includes('Files')) return;
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
  });
  el.addEventListener('dragleave', e => {
    el.classList.remove('drag-over');
    el._dragging = false;
    const rdz = document.getElementById('root-drop-zone');
    if (rdz) rdz.style.display = 'none';
  });
  el.addEventListener('drop', e => {
    e.preventDefault();
    e.stopPropagation();
    el.classList.remove('drag-over');
    el._dragging = false;
    const rdz = document.getElementById('root-drop-zone');
    if (rdz) rdz.style.display = 'none';
    handleFilesIntoFolder(e.dataTransfer.files, folderId);
  });
}

function handleFilesIntoFolder(files, folderId) {
  const htmlFiles = [...files].filter(f => f.name.endsWith('.html') || f.name.endsWith('.htm'));
  if (htmlFiles.length === 0) { showToast('⚠️ Only HTML files are accepted!'); return; }
  // Queue them all
  let processed = 0;
  htmlFiles.forEach(file => {
    const reader = new FileReader();
    reader.onload = async e => {
      const note = {
        id: 'n_' + Date.now() + '_' + Math.random().toString(36).slice(2,6),
        name: file.name.replace(/\.html?$/, ''),
        folder: folderId || null,
        tags: [],
        content: e.target.result,
        created: new Date().toISOString()
      };
      notes.push(note);
      processed++;
      if (processed === htmlFiles.length) {
        await saveUserData();
        const folderName = folderId ? (folders.find(f=>f.id===folderId)?.name || 'folder') : 'root';
        showToast(`${processed} note${processed>1?'s':''} added to ${folderName}!`);
        renderAll();
      }
    };
    reader.readAsText(file);
  });
}



// ============================================================
// NOTES RENDERING
// ============================================================
function renderAll() {
  renderFolderTree();
  renderFolderOptions('upload-folder');
  renderNotes();
  updateNotesCountMeta();
}

function getFolderPath(folderId) {
  if (!folderId) return '';
  const parts = [];
  let current = folderId;
  while (current) {
    const f = folders.find(x => x.id === current);
    if (!f) break;
    parts.unshift(f.name);
    current = f.parent;
  }
  return parts.join(' / ');
}

// ============================================================
// HOME NAVIGATION STATE
// ============================================================
let homeFolderId = null; // null = root, string = inside a folder

function navigateHome(folderId) {
  homeFolderId = folderId;
  activeTag = null;
  renderNotes();
}

function renderNotes() {
  const container = document.getElementById('notes-container');
  const emptyState = document.getElementById('empty-state');
  const breadcrumb = document.getElementById('home-breadcrumb');
  const pageTitle = document.getElementById('home-page-title');

  container.innerHTML = '';
  // --- Recent Notes Section ---
  if (!homeFolderId && !activeTag && notes.length > 0) {
    const recentNotes = [...notes]
      .sort((a, b) => new Date(b.updated || b.created) - new Date(a.updated || a.created))
      .slice(0, 4);

    if (recentNotes.length > 0) {
      const recentSec = document.createElement('div');
      recentSec.className = 'home-section-title';
      recentSec.style.cursor = 'pointer';
      recentSec.innerHTML = `<span class="sec-arrow" style="transition:0.2s">▼</span> <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:4px"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg> Recently Modified`;
      container.appendChild(recentSec);
      
      const recentGrid = document.createElement('div');
      recentGrid.id = 'recent-grid-container';
      recentGrid.className = 'notes-grid';
      recentSec.onclick = () => toggleSidebarSection('recent-grid-container', recentSec);
      recentGrid.style.marginBottom = '24px';
      recentNotes.forEach(n => {
        const card = makeNoteCard(n);
        card.style.borderStyle = 'dashed'; // Distinct look for recents
        recentGrid.appendChild(card);
      });
      container.appendChild(recentGrid);
    }
  }


  // --- Breadcrumb ---
  const bcPath = [];
  let cur = homeFolderId;
  while (cur) {
    const f = folders.find(x => x.id === cur);
    if (!f) break;
    bcPath.unshift(f);
    cur = f.parent;
  }
  if (bcPath.length > 0) {
    breadcrumb.style.display = 'flex';
    breadcrumb.innerHTML = '';
    // Home crumb
    const home = document.createElement('span');
    home.className = 'bc-item';
    home.textContent = '⌂ Home';
    home.onclick = () => navigateHome(null);
    breadcrumb.appendChild(home);
    bcPath.forEach((f, i) => {
      const sep = document.createElement('span'); sep.className = 'bc-sep'; sep.textContent = '›';
      breadcrumb.appendChild(sep);
      const item = document.createElement('span');
      item.className = 'bc-item' + (i === bcPath.length - 1 ? ' current' : '');
      item.textContent = f.name;
      if (i < bcPath.length - 1) item.onclick = () => navigateHome(f.id);
      breadcrumb.appendChild(item);
    });
    pageTitle.textContent = bcPath[bcPath.length - 1].name;
  } else {
    breadcrumb.style.display = 'none';
    pageTitle.textContent = 'All Notes';
  }

  // --- Tag filter bar (only at root) ---
  const allTags = [...new Set(notes.flatMap(n => n.tags||[]))];
  const tagBar = document.getElementById('tag-filter-bar');
  tagBar.innerHTML = '';
  if (allTags.length > 0 && !homeFolderId) {
    const all = document.createElement('div');
    all.className = 'tag-chip all' + (activeTag ? '' : ' active');
    all.textContent = 'All';
    all.onclick = () => clearTagFilter();
    tagBar.appendChild(all);
    allTags.forEach(tag => {
      const chip = document.createElement('div');
      chip.className = 'tag-chip' + (activeTag===tag?' active':'');
      chip.textContent = '#'+tag;
      chip.onclick = () => filterByTag(tag);
      tagBar.appendChild(chip);
    });
  }
  const ati = document.getElementById('active-tag-indicator');
  ati.style.display = activeTag ? 'flex' : 'none';
  if (activeTag) document.getElementById('active-tag-label').textContent = '#'+activeTag;

  // --- If tag filter is active, show flat note list ---
  if (activeTag) {
    const filtered = notes.filter(n => n.tags && n.tags.includes(activeTag));
    if (filtered.length === 0) { emptyState.style.display = ''; return; }
    emptyState.style.display = 'none';
    const grid = document.createElement('div'); grid.className = 'notes-grid';
    filtered.forEach(n => grid.appendChild(makeNoteCard(n)));
    container.appendChild(grid);
    return;
  }

  // --- Subfolders in current level ---
  const subfolders = folders.filter(f => (f.parent || null) === (homeFolderId || null));
  // --- Notes directly in current folder ---
  const localNotes = notes.filter(n => (n.folder || null) === (homeFolderId || null));

  if (subfolders.length === 0 && localNotes.length === 0) {
    emptyState.style.display = '';
    return;
  }
  emptyState.style.display = 'none';

  // --- Render subfolder cards ---
  if (subfolders.length > 0) {
    if (localNotes.length > 0) {
      const sec = document.createElement('div');
      sec.className = 'home-section-title';
      sec.style.cursor = 'pointer';
      sec.innerHTML = `<span class="sec-arrow" style="transition:0.2s">▼</span> Folders`;
      container.appendChild(sec);
      sec.onclick = () => toggleSidebarSection('folders-grid-container', sec);
    }
    const grid = document.createElement('div');
    grid.id = 'folders-grid-container'; grid.className = 'folder-card-grid';
    subfolders.forEach(f => grid.appendChild(makeFolderCard(f)));
    container.appendChild(grid);
  }

  // --- Render notes in this folder ---
  if (localNotes.length > 0) {
    if (subfolders.length > 0) {
      const sec = document.createElement('div');
      sec.className = 'home-section-title';
      sec.style.cursor = 'pointer';
      sec.innerHTML = `<span class="sec-arrow" style="transition:0.2s">▼</span> Notes`;
      container.appendChild(sec);
      sec.onclick = () => toggleSidebarSection('notes-list-container', sec);
    }
    if (currentView === 'list') {
      const list = document.createElement('div'); list.id = 'notes-list-container'; list.className = 'notes-list';
      localNotes.forEach(n => list.appendChild(makeNoteListItem(n)));
      container.appendChild(list);
    } else if (currentView === 'tree') {
      const tree = document.createElement('div'); tree.id = 'notes-list-container'; tree.className = 'notes-tree';
      // Structured Tree view for the main area
      function renderStructuredTree(pid, depth) {
        folders.filter(f => (f.parent || null) === pid).forEach(folder => {
          const fDiv = document.createElement('div');
          fDiv.style.paddingLeft = (depth * 20) + 'px';
          fDiv.style.marginBottom = '10px';
          fDiv.innerHTML = `<div class="home-section-title" style="margin-bottom:8px">📁 ${folder.name}</div>`;
          tree.appendChild(fDiv);
          
          const grid = document.createElement('div');
          grid.className = 'notes-grid';
          grid.style.paddingLeft = (depth * 20 + 20) + 'px';
          notes.filter(n => n.folder === folder.id).forEach(n => grid.appendChild(makeNoteCard(n)));
          if (grid.children.length > 0) tree.appendChild(grid);
          
          renderStructuredTree(folder.id, depth + 1);
        });
      }
      renderStructuredTree(homeFolderId, 0);
      
      const orphanedGrid = document.createElement('div');
      orphanedGrid.className = 'notes-grid';
      localNotes.forEach(n => orphanedGrid.appendChild(makeNoteCard(n)));
      if (orphanedGrid.children.length > 0) tree.appendChild(orphanedGrid);
      
      container.appendChild(tree);
    } else {
      const g = document.createElement('div'); g.id = 'notes-list-container'; g.className = 'notes-grid';
      localNotes.forEach(n => g.appendChild(makeNoteCard(n)));
      container.appendChild(g);
    }
  }
}

function makeFolderCard(f) {
  const card = document.createElement('div');
  card.className = 'folder-card';

  // Count total notes recursively
  function countNotes(fid) {
    let c = notes.filter(n => n.folder === fid).length;
    folders.filter(sf => sf.parent === fid).forEach(sf => { c += countNotes(sf.id); });
    return c;
  }
  const totalNotes = countNotes(f.id);
  const directNotes = notes.filter(n => n.folder === f.id).length;
  const subfolders = folders.filter(sf => sf.parent === f.id);

  const subPills = subfolders.slice(0, 4).map(sf =>
    `<span class="folder-sub-pill">${sf.name}</span>`
  ).join('') + (subfolders.length > 4 ? `<span class="folder-sub-pill">+${subfolders.length-4} more</span>` : '');

  card.innerHTML = `
    <div class="folder-card-icon">
      <svg viewBox="0 0 24 24" width="22" height="22">
        <path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z" fill="var(--accent)" opacity="0.25"/>
        <path d="M3 8l3-5h5l2 3h8a1 1 0 011 1" fill="none" stroke="var(--accent2)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <div class="folder-card-name">${f.name}</div>
    <div class="folder-card-meta">
      <span>${totalNotes} note${totalNotes!==1?'s':''}</span>
      ${subfolders.length > 0 ? `<span>${subfolders.length} subfolder${subfolders.length!==1?'s':''}</span>` : ''}
    </div>
    ${subPills ? `<div class="folder-card-subs">${subPills}</div>` : ''}
  `;
  card.addEventListener('click', () => navigateHome(f.id));
  return card;
}

function makeNoteCard(n) {
  const div = document.createElement('div');
  div.className = 'note-card';
  const tagHtml = (n.tags||[]).map(t=>`<span class="note-tag">#${t}</span>`).join('');
  const folderPath = getFolderPath(n.folder);
  const noteIconSVG = `<svg viewBox="0 0 24 24" width="22" height="22" style="display:block"><path d="M6 2h9l5 5v15a1 1 0 01-1 1H5a1 1 0 01-1-1V3a1 1 0 011-1z" fill="var(--accent)" opacity="0.18"/><path d="M14 2v6h6M8 13h8M8 17h5" fill="none" stroke="var(--accent2)" stroke-width="1.8" stroke-linecap="round"/></svg>`;
  div.innerHTML = `
    <div class="note-card-icon">${noteIconSVG}</div>
    <div class="note-card-name">${n.name}</div>
    <div class="note-card-meta">${tagHtml}</div>
    ${folderPath ? `<div class="note-folder-path">📁 ${folderPath}</div>` : ''}
    <div class="note-card-actions">
      <button class="note-act-btn" onclick="event.stopPropagation();openUpdateWindow('${n.id}')">⬆ Update</button>
      <button class="note-act-btn" onclick="event.stopPropagation();downloadNote('${n.id}')">Download</button>
      <button class="note-act-btn" onclick="event.stopPropagation();openNoteParentModal('${n.id}')">Change Folder</button>
    </div>
  `;
  div.addEventListener('click', () => openNote(n.id));
  return div;
}

function makeNoteListItem(n) {
  const div = document.createElement('div');
  div.className = 'note-list-item';
  const tagHtml = (n.tags||[]).map(t=>`<span class="note-tag">#${t}</span>`).join('');
  const folderPath = getFolderPath(n.folder);
  div.innerHTML = `
    <div class="note-list-icon"><svg viewBox="0 0 24 24" width="20" height="20"><path d="M6 2h9l5 5v15a1 1 0 01-1 1H5a1 1 0 01-1-1V3a1 1 0 011-1z" fill="var(--accent)" opacity="0.18"/><path d="M14 2v6h6M8 13h8M8 17h5" fill="none" stroke="var(--accent2)" stroke-width="1.8" stroke-linecap="round"/></svg></div>
    <div>
      <div class="note-list-name">${n.name}</div>
      ${folderPath ? `<div class="note-list-path">📁 ${folderPath}</div>` : ''}
      <div class="note-list-tags" style="margin-top:4px">${tagHtml}</div>
    </div>
    <div class="note-list-actions">
      <button class="note-act-btn" style="padding:5px 8px" onclick="event.stopPropagation();openUpdateWindow('${n.id}')">⬆ Update</button>
      <button class="note-act-btn" style="padding:5px 8px" onclick="event.stopPropagation();downloadNote('${n.id}')">Download</button>
      <button class="note-act-btn" style="padding:5px 8px" onclick="event.stopPropagation();openNoteParentModal('${n.id}')">Change Folder</button>
    </div>
  `;
  div.addEventListener('click', () => openNote(n.id));
  return div;
}

function updateNotesCountMeta() {
  const total = notes.length;
  const meta = document.getElementById('notes-count-meta');
  if (homeFolderId) {
    function countAll(fid) {
      let c = notes.filter(n => n.folder === fid).length;
      folders.filter(sf => sf.parent === fid).forEach(sf => { c += countAll(sf.id); });
      return c;
    }
    const cnt = countAll(homeFolderId);
    meta.textContent = cnt + ' note' + (cnt!==1?'s':'') + ' · ' + total + ' total';
  } else {
    meta.textContent = total + ' note' + (total!==1?'s':'');
  }
}

function setView(v) {
  currentView = v;
  ['grid','list','tree'].forEach(x => document.getElementById('view-'+x).classList.toggle('active', x===v));
  renderNotes();
}

function filterByTag(tag) {
  activeTag = tag;
  renderNotes();
}
function clearTagFilter() {
  activeTag = null;
  renderNotes();
}

// ============================================================
// UPLOAD
// ============================================================
function setupUploadZone() {
  const zone = document.getElementById('upload-zone');
  zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('dragover'); });
  zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
  zone.addEventListener('drop', e => {
    e.preventDefault();
    zone.classList.remove('dragover');
    handleFiles(e.dataTransfer.files);
  });
}

function handleFiles(files) {
  const htmlFiles = [...files].filter(f => f.name.endsWith('.html') || f.name.endsWith('.htm'));
  if (htmlFiles.length === 0) { showToast('⚠️ Only HTML files are accepted!'); return; }
  pendingFile = htmlFiles[0];
  uploadTags = [];
  document.getElementById('upload-file-name').textContent = '📄 ' + pendingFile.name;
  document.getElementById('upload-name').value = pendingFile.name.replace(/\.html?$/, '');
  renderFolderOptions('upload-folder');
  document.getElementById('upload-tags-wrap').innerHTML = '<input type="text" id="upload-tag-input" placeholder="Type a tag…" onkeydown="handleTagInput(event)">';
  document.getElementById('upload-form').style.display = '';
  navigate('upload');
}

function handleTagInput(e) {
  if (e.key === 'Enter' || e.key === ',') {
    e.preventDefault();
    const val = e.target.value.trim().replace(/,/g,'');
    if (val && !uploadTags.includes(val)) {
      uploadTags.push(val);
      renderTagPills();
    }
    e.target.value = '';
  } else if (e.key === 'Backspace' && e.target.value === '' && uploadTags.length) {
    uploadTags.pop();
    renderTagPills();
  }
}

function renderTagPills() {
  const wrap = document.getElementById('upload-tags-wrap');
  const input = document.getElementById('upload-tag-input');
  wrap.innerHTML = '';
  uploadTags.forEach((tag, i) => {
    const pill = document.createElement('span');
    pill.className = 'tag-pill';
    pill.innerHTML = `${tag}<span class="tag-pill-remove" onclick="removeUploadTag(${i})">×</span>`;
    wrap.appendChild(pill);
  });
  const newInput = document.createElement('input');
  newInput.type = 'text';
  newInput.id = 'upload-tag-input';
  newInput.placeholder = 'Type a tag…';
  newInput.setAttribute('onkeydown', 'handleTagInput(event)');
  wrap.appendChild(newInput);
}
function removeUploadTag(i) { uploadTags.splice(i,1); renderTagPills(); }

function saveNote() {
  if (!pendingFile) return;
  const name = document.getElementById('upload-name').value.trim() || pendingFile.name;
  const folder = document.getElementById('upload-folder').value || null;
  
  const reader = new FileReader();
  reader.onload = async e => {
    const note = {
      id: 'n_' + Date.now(),
      name,
      folder: folder,
      tags: [...uploadTags],
      content: e.target.result,
      created: new Date().toISOString()
    };
    notes.push(note);
    await saveUserData();
    pendingFile = null;
    uploadTags = [];
    document.getElementById('upload-form').style.display = 'none';
    showToast('Note saved! ✓');
    navigate('home');
    renderAll();
  };
  reader.readAsText(pendingFile);
}
function cancelUpload() {
  pendingFile = null;
  document.getElementById('upload-form').style.display = 'none';
  navigate('home');
}

// ============================================================
// NOTE VIEWER
// ============================================================
let floatingWindowCount = 0;

function openNote(id) {
  const note = notes.find(n => n.id === id);
  if (!note) return;
  
  const windowId = 'floating-note-' + (floatingWindowCount++);
  const container = document.getElementById('floating-windows');
  
  const noteWindow = document.createElement('div');
  noteWindow.id = windowId;
  noteWindow.className = 'note-window active';
  noteWindow.style.width = '780px';
  noteWindow.style.height = '560px';
  noteWindow.style.left = (50 + floatingWindowCount * 20) + 'px';
  noteWindow.style.top = (50 + floatingWindowCount * 20) + 'px';
  
  const titlebar = document.createElement('div');
  titlebar.className = 'note-window-titlebar';
  titlebar.innerHTML = `
    <span class="win-title" data-note-id="${id}">${note.name}</span>
    <button class="win-btn" onclick="changeNoteParentFromWindow('${id}')" title="Change folder">
      <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 8h18v13a1 1 0 01-1 1H4a1 1 0 01-1-1V8z"/><path d="M3 8l3-5h5l2 3h8a1 1 0 011 1M9 12v6M15 12v6"/></svg>
    </button>
    <button class="win-btn" onclick="openNoteInNewWindow('${id}')" title="Open another window">
      <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"/></svg>
    </button>
    <button class="win-btn fullscreen" onclick="toggleFullscreenWindow('${windowId}')" title="Fullscreen">
      <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 3H5a2 2 0 00-2 2v3M16 3h3a2 2 0 012 2v3M21 16v3a2 2 0 01-2 2h-3M8 21H5a2 2 0 01-2-2v-3"/></svg>
    </button>
    <button class="win-btn close" onclick="closeFloatingWindow('${windowId}')" title="Close">
      <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  `;
  
  const body = document.createElement('div');
  body.className = 'note-window-body';
  const iframe = document.createElement('iframe');
  iframe.sandbox = 'allow-scripts allow-same-origin';
  const blob = new Blob([note.content], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  iframe.src = url;
  body.appendChild(iframe);
  
  const resizeHandle = document.createElement('div');
  resizeHandle.className = 'resize-handle';
  resizeHandle.innerHTML = '<svg viewBox="0 0 10 10" width="10" height="10" fill="none" stroke="var(--text3)" stroke-width="1.2" stroke-linecap="round"><line x1="9" y1="1" x2="1" y2="9"/><line x1="9" y1="5" x2="5" y2="9"/></svg>';
  
  noteWindow.appendChild(titlebar);
  noteWindow.appendChild(body);
  noteWindow.appendChild(resizeHandle);
  container.appendChild(noteWindow);
  
  makeDraggable(windowId);
  makeResizable(windowId);
  
  // Highlight in sidebar
  document.querySelectorAll('.folder-note-item').forEach(el => el.classList.remove('active'));
  const sfn = document.getElementById('sfn_'+id);
  if (sfn) sfn.classList.add('active');
}


function closeNoteViewer() {
  if (document.fullscreenElement || document.webkitFullscreenElement) {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
  }
  document.getElementById('note-viewer').classList.remove('open');
  document.getElementById('note-iframe').src = '';
  document.querySelectorAll('.folder-note-item').forEach(el => el.classList.remove('active'));
}


function setNoteViewerParent(folderId) {
  const titleEl = document.getElementById('note-win-title');
  const noteId = titleEl.getAttribute('data-note-id');
  if (!noteId) return;
  
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  note.folder = folderId;
  saveUserData();
  renderAll();
  showToast('Folder changed!');
  const modal = document.getElementById('note-viewer-parent-modal');
  if (modal) modal.remove();
}

function changeNoteParentFromWindow(noteId) {
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  let html = '<div style="max-height:300px;overflow-y:auto">';
  folders.forEach(f => {
    const isSelected = f.id === note.folder ? 'style="background:var(--accent-glow);"' : '';
    html += `<div class="ctx-item" ${isSelected} style="padding:12px;cursor:pointer;margin-bottom:8px;" onclick="setNoteWindowParent('${noteId}', '${f.id}')">${f.name}</div>`;
  });
  html += '</div>';
  
  const modal = document.createElement('div');
  modal.id = 'note-window-parent-modal';
  modal.style.cssText = 'position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;pointer-events:auto;';
  modal.innerHTML = `
    <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;max-width:400px;width:90%;">
      <div style="font-weight:700;margin-bottom:12px;font-size:1rem;">Select Folder for "${note.name}"</div>
      ${html}
      <button style="margin-top:12px;width:100%;padding:8px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;color:var(--text);font-family:var(--font);" onclick="document.getElementById('note-window-parent-modal').remove()">Cancel</button>
    </div>
  `;
  document.body.appendChild(modal);
}

function setNoteWindowParent(noteId, folderId) {
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  note.folder = folderId;
  saveUserData();
  renderAll();
  showToast('Folder changed!');
  const modal = document.getElementById('note-window-parent-modal');
  if (modal) modal.remove();
}

function makeDraggable(windowId) {
  const el = document.getElementById(windowId);
  const titlebar = el.querySelector('.note-window-titlebar');
  let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  
  titlebar.onmousedown = dragMouseDown;
  
  function dragMouseDown(e) {
    e.preventDefault();
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    document.onmousemove = elementDrag;
    el.classList.add('active');
  }
  
  function elementDrag(e) {
    e.preventDefault();
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    el.style.top = (el.offsetTop - pos2) + 'px';
    el.style.left = (el.offsetLeft - pos1) + 'px';
  }
  
  function closeDragElement() {
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

function makeResizable(windowId) {
  const el = document.getElementById(windowId);
  const resizeHandle = el.querySelector('.resize-handle');
  let isResizing = false;
  let startX, startY, startWidth, startHeight;
  
  resizeHandle.onmousedown = (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = el.offsetWidth;
    startHeight = el.offsetHeight;
    document.onmousemove = resize;
    document.onmouseup = stopResize;
  };
  
  function resize(e) {
    if (!isResizing) return;
    el.style.width = (startWidth + e.clientX - startX) + 'px';
    el.style.height = (startHeight + e.clientY - startY) + 'px';
  }
  
  function stopResize() {
    isResizing = false;
    document.onmousemove = null;
    document.onmouseup = null;
  }
}

function closeFloatingWindow(windowId) {
  const el = document.getElementById(windowId);
  if (el) el.remove();
}

function openNoteInNewWindow(id) {
  openNote(id);
}

function toggleFullscreenWindow(windowId) {
  const el = document.getElementById(windowId);
  if (!el) return;
  el.classList.toggle('fullscreen-win');
}

function changeNoteParentFromWindow(noteId) {
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  
  const modal = document.createElement('div');
  modal.id = 'window-parent-select-modal';
  modal.style.cssText = 'position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;pointer-events:auto;';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  const content = document.createElement('div');
  content.style.cssText = 'background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;max-width:400px;width:90%;';
  
  const title = document.createElement('div');
  title.style.cssText = 'font-weight:700;margin-bottom:16px;font-size:1rem;color:var(--text);';
  title.textContent = `Change Folder for "${note.name}"`;
  
  const optionsDiv = document.createElement('div');
  optionsDiv.style.cssText = 'max-height:300px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;margin-bottom:16px;';
  
  // Folder options
  folders.forEach(f => {
    const isSelected = f.id === note.folder;
    const btn = document.createElement('button');
    btn.style.cssText = `padding:12px;background:${isSelected ? 'var(--accent-glow)' : 'var(--bg3)'};border:1px solid var(--border);border-radius:6px;cursor:pointer;text-align:left;color:var(--text);font-family:var(--font);transition:all 0.18s;`;
    btn.textContent = f.name;
    btn.dataset.folderId = f.id;
    btn.dataset.isSelected = isSelected;
    btn.onclick = (e) => { e.stopPropagation(); setNoteParentFromWindow(noteId, f.id); modal.remove(); };
    btn.onmouseover = () => { btn.style.background = 'var(--bg4)'; };
    btn.onmouseout = () => { btn.style.background = btn.dataset.isSelected === 'true' ? 'var(--accent-glow)' : 'var(--bg3)'; };
    optionsDiv.appendChild(btn);
  });
  
  const cancelBtn = document.createElement('button');
  cancelBtn.style.cssText = 'width:100%;padding:10px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;cursor:pointer;color:var(--text);font-family:var(--font);font-weight:600;transition:all 0.18s;';
  cancelBtn.textContent = 'Cancel';
  cancelBtn.onclick = () => modal.remove();
  cancelBtn.onmouseover = () => { cancelBtn.style.background = 'var(--bg4)'; };
  cancelBtn.onmouseout = () => { cancelBtn.style.background = 'var(--bg3)'; };
  
  content.appendChild(title);
  content.appendChild(optionsDiv);
  content.appendChild(cancelBtn);
  modal.appendChild(content);
  document.body.appendChild(modal);
}

function setNoteParentFromWindow(noteId, folderId) {
  const note = notes.find(n => n.id === noteId);
  if (!note) return;
  note.folder = folderId;
  saveUserData();
  renderAll();
  showToast('Folder changed!');
  const modal = document.getElementById('window-parent-select-modal');
  if (modal) modal.remove();
}

function toggleFullscreenWin() {
  const win = document.getElementById('note-window');
  const viewer = document.getElementById('note-viewer');
  const isFullscreen = win.classList.contains('fullscreen-win');
  
  if (!isFullscreen) {
    win.classList.add('fullscreen-win');
    win.style.cssText = '';
    // Try browser fullscreen
    if (viewer.requestFullscreen) viewer.requestFullscreen();
    else if (viewer.webkitRequestFullscreen) viewer.webkitRequestFullscreen();
  } else {
    win.classList.remove('fullscreen-win');
    // Exit browser fullscreen
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    // Restore default size
    const isMobile = window.innerWidth <= 700;
    if (isMobile) {
      win.style.cssText = 'width:92vw;height:75vh;left:4vw;top:10vh;transform:none;';
    } else {
      win.style.cssText = 'width:780px;height:560px;left:50%;top:50%;transform:translate(-50%,-50%);';
    }
  }
}

// Handle fullscreen change from browser (e.g. Escape key)
document.addEventListener('fullscreenchange', () => {
  if (!document.fullscreenElement) {
    const win = document.getElementById('note-window');
    if (win && win.classList.contains('fullscreen-win')) {
      win.classList.remove('fullscreen-win');
      const isMobile = window.innerWidth <= 700;
      if (isMobile) {
        win.style.cssText = 'width:92vw;height:75vh;left:4vw;top:10vh;transform:none;';
      } else {
        win.style.cssText = 'width:780px;height:560px;left:50%;top:50%;transform:translate(-50%,-50%);';
      }
    }
  }
});

// Click overlay to close
document.getElementById('note-viewer').addEventListener('click', function(e) {
  if (e.target === this) closeNoteViewer();
});

// Drag & Resize
function setupDragResize() {
  const win = document.getElementById('note-window');
  const titlebar = document.getElementById('note-win-titlebar');
  const resizeHandle = document.getElementById('resize-handle');
  let dragging = false, resizing = false;
  let startX, startY, startW, startH, startLeft, startTop;

  titlebar.addEventListener('mousedown', e => {
    if (win.classList.contains('fullscreen-win')) return;
    dragging = true;
    startX = e.clientX; startY = e.clientY;
    const rect = win.getBoundingClientRect();
    startLeft = rect.left; startTop = rect.top;
    win.style.transform = 'none';
    win.style.left = startLeft + 'px';
    win.style.top = startTop + 'px';
  });
  resizeHandle.addEventListener('mousedown', e => {
    e.stopPropagation();
    resizing = true;
    startX = e.clientX; startY = e.clientY;
    const rect = win.getBoundingClientRect();
    startW = rect.width; startH = rect.height;
    startLeft = rect.left; startTop = rect.top;
    win.style.transform = 'none';
    win.style.left = startLeft + 'px';
    win.style.top = startTop + 'px';
  });
  document.addEventListener('mousemove', e => {
    if (dragging) {
      win.style.left = (startLeft + e.clientX - startX) + 'px';
      win.style.top = (startTop + e.clientY - startY) + 'px';
    } else if (resizing) {
      const newW = Math.max(320, startW + e.clientX - startX);
      const newH = Math.max(200, startH + e.clientY - startY);
      win.style.width = newW + 'px';
      win.style.height = newH + 'px';
    }
  });
  document.addEventListener('mouseup', () => { dragging = false; resizing = false; });

  // Touch drag for mobile
  titlebar.addEventListener('touchstart', e => {
    if (win.classList.contains('fullscreen-win')) return;
    const t = e.touches[0];
    dragging = true;
    startX = t.clientX; startY = t.clientY;
    const rect = win.getBoundingClientRect();
    startLeft = rect.left; startTop = rect.top;
    win.style.transform = 'none';
    win.style.left = startLeft + 'px';
    win.style.top = startTop + 'px';
  }, {passive:true});
  document.addEventListener('touchmove', e => {
    if (!dragging) return;
    const t = e.touches[0];
    win.style.left = (startLeft + t.clientX - startX) + 'px';
    win.style.top = (startTop + t.clientY - startY) + 'px';
  }, {passive:true});
  document.addEventListener('touchend', () => { dragging = false; resizing = false; });
}

// ============================================================
// RENAME / DELETE / DOWNLOAD
// ============================================================
function openRenameModal(id) {
  renameTarget = id;
  const note = notes.find(n => n.id===id);
  document.getElementById('rename-input').value = note.name;
  document.getElementById('rename-modal').classList.add('open');
  setTimeout(() => document.getElementById('rename-input').focus(), 50);
}
function closeRenameModal() { document.getElementById('rename-modal').classList.remove('open'); }
async function confirmRename() {
  const val = document.getElementById('rename-input').value.trim();
  if (!val) return;
  const note = notes.find(n => n.id===renameTarget);
  note.name = val;
  await saveUserData();
  closeRenameModal();
  renderAll();
  showToast('Note renamed!');
}

function openDeleteModal(id) {
  deleteTarget = id;
  const note = notes.find(n => n.id===id);
  document.getElementById('delete-note-name').textContent = note.name;
  document.getElementById('delete-modal').classList.add('open');
}
function closeDeleteModal() { document.getElementById('delete-modal').classList.remove('open'); }
async function confirmDelete() {
  notes = notes.filter(n => n.id !== deleteTarget);
  await saveUserData();
  closeDeleteModal();
  renderAll();
  showToast('Note deleted!');
}

// ============================================================
// REUPLOAD / UPDATE NOTE
// ============================================================
let reuploadTarget = null;
let reuploadPendingFile = null;

function openReuploadModal(id) {
  reuploadTarget = id;
  reuploadPendingFile = null;
  const note = notes.find(n => n.id === id);
  document.getElementById('reupload-note-name').textContent = note.name;
  document.getElementById('reupload-selected-name').textContent = 'No file selected';
  document.getElementById('reupload-confirm-btn').disabled = true;
  document.getElementById('reupload-confirm-btn').style.opacity = '0.5';
  document.getElementById('reupload-file-input').value = '';
  document.getElementById('reupload-modal').classList.add('open');
  // Setup drag/drop on the zone
  const zone = document.getElementById('reupload-zone');
  zone.ondragover = e => { e.preventDefault(); zone.classList.add('dragover'); };
  zone.ondragleave = () => zone.classList.remove('dragover');
  zone.ondrop = e => { e.preventDefault(); zone.classList.remove('dragover'); handleReuploadFile(e.dataTransfer.files); };
}

function closeReuploadModal() {
  document.getElementById('reupload-modal').classList.remove('open');
  reuploadTarget = null;
  reuploadPendingFile = null;
}

async function deleteFromReuploadModal() {
  if (!reuploadTarget) return;
  notes = notes.filter(n => n.id !== reuploadTarget);
  await saveUserData();
  closeReuploadModal();
  renderAll();
  showToast('Note deleted!');
}

function handleReuploadFile(files) {
  const f = [...files].find(f => f.name.endsWith('.html') || f.name.endsWith('.htm'));
  if (!f) { showToast('⚠️ Only HTML files accepted!'); return; }
  reuploadPendingFile = f;
  document.getElementById('reupload-selected-name').textContent = '📄 ' + f.name;
  document.getElementById('reupload-confirm-btn').disabled = false;
  document.getElementById('reupload-confirm-btn').style.opacity = '1';
}

async function confirmReupload() {
  if (!reuploadPendingFile || !reuploadTarget) return;
  const reader = new FileReader();
  reader.onload = async e => {
    const note = notes.find(n => n.id === reuploadTarget);
    if (!note) return;
    note.content = e.target.result;
    note.updated = new Date().toISOString();
    await saveUserData();
    closeReuploadModal();
    showToast('Note updated!');
    renderAll();
  };
  reader.readAsText(reuploadPendingFile);
}

function downloadNote(id) {
  const note = notes.find(n => n.id===id);
  if (!note) return;
  const blob = new Blob([note.content], {type:'text/html'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = note.name + '.html';
  a.click();
  showToast('Downloading…');
}

// ============================================================
// TOAST
// ============================================================
let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2400);
}

// Enter key on modals
document.getElementById('rename-input').addEventListener('keydown', e => { if(e.key==='Enter') confirmRename(); });
document.getElementById('folder-name-input').addEventListener('keydown', e => { if(e.key==='Enter') createFolder(); });
document.getElementById('rename-folder-input').addEventListener('keydown', e => { if(e.key==='Enter') confirmRenameFolder(); });

// Also wire the sidebar scroll area as a drop target for root (no folder)
function setupSidebarDrop() {
  const scroll = document.querySelector('.sidebar-scroll');
  if (!scroll) return;
  scroll.addEventListener('dragenter', e => {
    if (!e.dataTransfer.types.includes('Files')) return;
    e.preventDefault();
    const rdz = document.getElementById('root-drop-zone');
    if (rdz) rdz.style.display = 'flex';
  });
  scroll.addEventListener('dragover', e => {
    if (!e.dataTransfer.types.includes('Files')) return;
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
  });
  scroll.addEventListener('dragleave', e => {
    // Only hide if we've left the entire sidebar scroll
    if (!scroll.contains(e.relatedTarget)) {
      const rdz = document.getElementById('root-drop-zone');
      if (rdz) rdz.style.display = 'none';
    }
  });
  scroll.addEventListener('drop', e => {
    e.preventDefault();
    const rdz = document.getElementById('root-drop-zone');
    if (rdz) rdz.style.display = 'none';
    // Only handle if not already handled by a folder header
    handleFilesIntoFolder(e.dataTransfer.files, null);
  });
}

// Close modals clicking overlay
['folder-modal','rename-modal','delete-modal','reupload-modal','delete-folder-modal','rename-folder-modal'].forEach(id => {
  const el = document.getElementById(id);
  if (el) el.addEventListener('click', function(e) {
    if (e.target === this) this.classList.remove('open');
  });
});
</script>

<!-- Firebase via REST API - no SDK needed, works without CDN -->
<script>
// ============================================================
// FIREBASE REST API WRAPPER (no SDK - pure fetch)
// ============================================================
const FB_API_KEY = "AIzaSyBKK7lSt7_S9zhibXEkpAl75gBUWxKcwmA";
const FB_DB_URL  = "https://notez-e2e36-default-rtdb.firebaseio.com";
const FB_AUTH_URL = "https://identitytoolkit.googleapis.com/v1/accounts";

let _fbIdToken = null;
let _fbRefreshToken = null;
let _fbUid = null;
let _fbDisplayName = null;
let _tokenExpiry = 0;

// Persist session in localStorage
function _saveSession(idToken, refreshToken, uid, displayName, expiresIn) {
  _fbIdToken = idToken;
  _fbRefreshToken = refreshToken;
  _fbUid = uid;
  _fbDisplayName = displayName;
  _tokenExpiry = Date.now() + (parseInt(expiresIn) - 60) * 1000;
  localStorage.setItem('notez_fb_session', JSON.stringify({ idToken, refreshToken, uid, displayName, expiresIn: _tokenExpiry }));
}

function _clearSession() {
  _fbIdToken = null; _fbRefreshToken = null; _fbUid = null; _fbDisplayName = null; _tokenExpiry = 0;
  localStorage.removeItem('notez_fb_session');
}

async function _getToken() {
  if (_fbIdToken && Date.now() < _tokenExpiry) return _fbIdToken;
  // Refresh token
  if (!_fbRefreshToken) return null;
  try {
    const r = await fetch(`https://securetoken.googleapis.com/v1/token?key=${FB_API_KEY}`, {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ grant_type:'refresh_token', refresh_token: _fbRefreshToken })
    });
    const d = await r.json();
    if (d.id_token) {
      _fbIdToken = d.id_token;
      _fbRefreshToken = d.refresh_token;
      _tokenExpiry = Date.now() + (parseInt(d.expires_in) - 60) * 1000;
      const sess = JSON.parse(localStorage.getItem('notez_fb_session') || '{}');
      sess.idToken = _fbIdToken; sess.refreshToken = _fbRefreshToken; sess.expiresIn = _tokenExpiry;
      localStorage.setItem('notez_fb_session', JSON.stringify(sess));
      return _fbIdToken;
    }
  } catch(e) {}
  _clearSession();
  return null;
}

async function fbSignIn(email, password) {
  const r = await fetch(`${FB_AUTH_URL}:signInWithPassword?key=${FB_API_KEY}`, {
    method: 'POST', headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ email, password, returnSecureToken: true })
  });
  const d = await r.json();
  if (d.error) throw new Error(d.error.message);
  _saveSession(d.idToken, d.refreshToken, d.localId, d.displayName || email.split('@')[0], d.expiresIn);
  return { uid: d.localId, displayName: d.displayName || email.split('@')[0], email: d.email };
}

async function fbSignUp(email, password, displayName) {
  const r = await fetch(`${FB_AUTH_URL}:signUp?key=${FB_API_KEY}`, {
    method: 'POST', headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ email, password, returnSecureToken: true })
  });
  const d = await r.json();
  if (d.error) throw new Error(d.error.message);
  // Set display name
  await fetch(`${FB_AUTH_URL}:update?key=${FB_API_KEY}`, {
    method: 'POST', headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ idToken: d.idToken, displayName, returnSecureToken: false })
  });
  _saveSession(d.idToken, d.refreshToken, d.localId, displayName, d.expiresIn);
  return { uid: d.localId, displayName, email: d.email };
}

function fbSignOut() {
  _clearSession();
}

// ============================================================
// INIT - check for saved session and boot app
// ============================================================
async function initApp() {
  setupDragResize();
  setupUploadZone();
  setupSidebarDrop();

  document.getElementById('login-password').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });
  document.getElementById('login-username').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });

  // Try to restore session
  try {
    const sess = JSON.parse(localStorage.getItem('notez_fb_session') || 'null');
    if (sess && sess.refreshToken) {
      _fbIdToken = sess.idToken;
      _fbRefreshToken = sess.refreshToken;
      _fbUid = sess.uid;
      _fbDisplayName = sess.displayName;
      _tokenExpiry = sess.expiresIn || 0;
      // Validate by getting a fresh token
      const token = await _getToken();
      if (token) {
        currentUser = _fbUid;
        await loadUserDataFromFirebase();
        const displayName = _fbDisplayName || 'User';
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('app').style.display = 'flex';
        document.getElementById('user-avatar-text').textContent = displayName[0].toUpperCase();
        document.getElementById('user-avatar-text').title = displayName;
        applySettings();
        renderAll();
        document.getElementById('app-loading').style.display = 'none';
        return;
      }
    }
  } catch(e) { _clearSession(); }

  // No valid session
  document.getElementById('app-loading').style.display = 'none';
  document.getElementById('login-screen').style.display = 'flex';
}


function toggleSidebar() {
  if (window.innerWidth <= 850) pushState();
  const sb = document.getElementById('sidebar');
  const ov = document.getElementById('mobile-overlay');
  if (window.innerWidth <= 850) {
    sb.classList.toggle('mobile-active');
    ov.classList.toggle('active');
  } else {
    sb.classList.toggle('collapsed');
  }
}

function closeMobileSidebar() {
  const sb = document.getElementById('sidebar');
  const ov = document.getElementById('mobile-overlay');
  if (sb) sb.classList.remove('mobile-active');
  if (ov) ov.classList.remove('active');
}

// Redirect all navigation clicks to close sidebar
const originalOpenNote = openNote;
openNote = function(id) {
    closeMobileSidebar();
    pushState(); originalOpenNote(id);
};

const originalNavigateHome = navigateHome;
navigateHome = function(id) {
    closeMobileSidebar();
    originalNavigateHome(id);
};


// --- History API / Back Button Handling ---
function pushState() {
    history.pushState({ open: true }, "");
}

// Global handler for back button
window.addEventListener('popstate', function(event) {
    // Collect all elements that might be "open"
    const noteViewer = document.getElementById('note-viewer');
    const profilePanel = document.getElementById('profile-panel');
    const sidebar = document.getElementById('sidebar');
    const modals = document.querySelectorAll('.modal-overlay.open');
    
    let handled = false;

    // 1. Close Modals
    if (modals.length > 0) {
        modals.forEach(m => m.classList.remove('open'));
        handled = true;
    }
    
    // 2. Close Note Viewer (and full screen)
    if (noteViewer && noteViewer.classList.contains('open')) {
        closeNoteViewer();
        handled = true;
    }
    
    // 3. Close Profile Panel
    if (profilePanel && profilePanel.classList.contains('open')) {
        closeProfilePanel();
        handled = true;
    }

    // 4. Close Mobile Sidebar
    if (sidebar && sidebar.classList.contains('mobile-active')) {
        closeMobileSidebar();
        handled = true;
    }

    // If something was open, we handled it. 
    // If not, the browser will proceed with its default back behavior.
});

// Update existing functions to push state when opening things
const wrapPush = (fnName) => {
    const original = window[fnName];
    window[fnName] = function(...args) {
        pushState();
        return original.apply(this, args);
    };
};


function toggleSidebarSection(id, el) {
  const target = document.getElementById(id);
  const arrow = el.querySelector('.sec-arrow');
  if (target.style.display === 'none') {
    target.style.display = '';
    if(arrow) arrow.style.transform = 'rotate(0deg)';
  } else {
    target.style.display = 'none';
    if(arrow) arrow.style.transform = 'rotate(-90deg)';
  }
}


// ============================================================
// OFFLINE STORAGE — IndexedDB (much larger than localStorage)
// ============================================================
const IDB_NAME = 'notez_offline';
const IDB_STORE = 'data';
const IDB_KEY = () => `offline_${_fbUid}`;

function openIDB() {
  return new Promise((resolve, reject) => {
    const req = indexedDB.open(IDB_NAME, 1);
    req.onupgradeneeded = e => e.target.result.createObjectStore(IDB_STORE);
    req.onsuccess = e => resolve(e.target.result);
    req.onerror = () => reject(req.error);
  });
}

async function saveToIDB(data) {
  const db = await openIDB();
  return new Promise((resolve, reject) => {
    const tx = db.transaction(IDB_STORE, 'readwrite');
    tx.objectStore(IDB_STORE).put(data, IDB_KEY());
    tx.oncomplete = resolve;
    tx.onerror = () => reject(tx.error);
  });
}

async function loadFromIDB() {
  try {
    const db = await openIDB();
    return new Promise((resolve) => {
      const tx = db.transaction(IDB_STORE, 'readonly');
      const req = tx.objectStore(IDB_STORE).get(IDB_KEY());
      req.onsuccess = () => resolve(req.result || null);
      req.onerror = () => resolve(null);
    });
  } catch(e) { return null; }
}

async function clearIDB() {
  const db = await openIDB();
  return new Promise((resolve) => {
    const tx = db.transaction(IDB_STORE, 'readwrite');
    tx.objectStore(IDB_STORE).delete(IDB_KEY());
    tx.oncomplete = resolve;
  });
}

function setOfflineStatus(msg, color) {
  const el = document.getElementById('offline-status');
  if (el) { el.textContent = msg; el.style.color = color || 'var(--text3)'; }
}

async function downloadOffline() {
  const btn = document.getElementById('offline-save-btn');
  if (btn) { btn.disabled = true; btn.innerHTML = '⏳ Saving...'; }
  setOfflineStatus('Fetching latest data from Firebase...', 'var(--text2)');

  try {
    // Pull fresh data from Firebase first if online
    if (navigator.onLine) {
      await loadFromFirebase();
    }

    const payload = {
      notes,
      folders,
      settings,
      savedAt: new Date().toISOString(),
      uid: _fbUid
    };

    // Save to IndexedDB (no size limit issues)
    await saveToIDB(payload);

    // Also save to localStorage as backup (slim if needed)
    saveLocal();

    const noteCount = notes.length;
    const size = new Blob([JSON.stringify(payload)]).size;
    const sizeStr = size > 1024*1024 ? (size/1024/1024).toFixed(1)+'MB' : (size/1024).toFixed(0)+'KB';
    setOfflineStatus(`✓ Saved ${noteCount} notes (${sizeStr}) — Last synced: ${new Date().toLocaleTimeString()}`, 'var(--success)');
    showToast('Saved for offline access!');
  } catch(e) {
    setOfflineStatus('✗ Save failed: ' + e.message, 'var(--danger)');
    showToast('Offline save failed');
  }

  if (btn) {
    btn.disabled = false;
    btn.innerHTML = '<svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Save for Offline';
  }
}

async function clearOffline() {
  if (!confirm('Clear all offline data from this device?')) return;
  try {
    await clearIDB();
    localStorage.removeItem(LS_KEY());
    setOfflineStatus('Offline data cleared.', 'var(--text3)');
    showToast('Offline data cleared');
  } catch(e) {
    showToast('Failed to clear offline data');
  }
}

// On load — check if offline data exists and show status
async function checkOfflineStatus() {
  const cached = await loadFromIDB();
  const profileEl = document.getElementById('profile-offline-status');
  if (cached) {
    const d = new Date(cached.savedAt);
    const msg = `✓ ${cached.notes?.length || 0} notes — ${d.toLocaleDateString()} ${d.toLocaleTimeString()}`;
    setOfflineStatus(`✓ Offline data available — ${cached.notes?.length || 0} notes saved on ${d.toLocaleDateString()} ${d.toLocaleTimeString()}`, 'var(--success)');
    if (profileEl) { profileEl.textContent = msg; profileEl.style.color = 'var(--success)'; }
  } else {
    setOfflineStatus('No offline data saved yet.', 'var(--text3)');
    if (profileEl) { profileEl.textContent = 'No offline data saved yet.'; profileEl.style.color = 'var(--text3)'; }
  }
}

// Override loadUserDataFromFirebase to also try IDB when fully offline
const _origLoadUserData = loadUserDataFromFirebase;
loadUserDataFromFirebase = async function() {
  if (!navigator.onLine) {
    // Offline — try IDB first, then localStorage
    const cached = await loadFromIDB();
    if (cached) {
      notes = cached.notes || [];
      folders = cached.folders || [];
      settings = cached.settings || { theme:'dark', accent:'purple' };
      showToast('Loaded offline data');
      return;
    }
    loadLocal();
    return;
  }
  await _origLoadUserData();
};


// ============================================================
// OFFLINE AUTOSAVE
// ============================================================
let _offlineAutosaveEnabled = false;
let _offlineAutosaveTimer = null;

function toggleOfflineAutosave(enabled) {
  _offlineAutosaveEnabled = enabled;
  localStorage.setItem('notez_offline_autosave', enabled ? '1' : '0');
  updateAutosaveToggleUI(enabled);
  if (enabled) showToast('Auto-save offline enabled');
  else showToast('Auto-save offline disabled');
}

function updateAutosaveToggleUI(enabled) {
  // Update both settings and profile toggles
  [
    {track:'offline-autosave-track', thumb:'offline-autosave-thumb', cb:'offline-autosave-toggle', offset:'20px'},
    {track:'profile-autosave-track', thumb:'profile-autosave-thumb', cb:'profile-autosave-toggle', offset:'18px'}
  ].forEach(({track, thumb, cb, offset}) => {
    const t = document.getElementById(track);
    const th = document.getElementById(thumb);
    const c = document.getElementById(cb);
    if (!t) return;
    if (enabled) {
      t.style.background = 'var(--accent)';
      t.style.borderColor = 'var(--accent)';
      th.style.background = '#fff';
      th.style.transform = `translateX(${offset})`;
    } else {
      t.style.background = 'var(--bg4)';
      t.style.borderColor = 'var(--border)';
      th.style.background = 'var(--text3)';
      th.style.transform = 'translateX(0)';
    }
    if (c) c.checked = enabled;
  });
}

function scheduleOfflineAutosave() {
  if (!_offlineAutosaveEnabled) return;
  clearTimeout(_offlineAutosaveTimer);
  _offlineAutosaveTimer = setTimeout(async () => {
    const payload = { notes, folders, settings, savedAt: new Date().toISOString(), uid: _fbUid };
    try {
      await saveToIDB(payload);
      saveLocal();
      setOfflineStatus('✓ Auto-saved — ' + new Date().toLocaleTimeString(), 'var(--success)');
    } catch(e) { console.warn('Autosave failed:', e); }
  }, 3000); // debounce 3s after last change
}

initApp().then ? initApp() : initApp();
// Init autosave pref
window.addEventListener('load', () => {
  _offlineAutosaveEnabled = localStorage.getItem('notez_offline_autosave') === '1';
});
</script>

<script>
// PWA Install prompt capture
let deferredPrompt = null;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  window._pwaInstallPrompt = e;
});
window.addEventListener('appinstalled', () => { deferredPrompt = null; });

// Register external service worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/NoteZ/sw.js', { scope: '/NoteZ/' })
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.warn('SW failed:', err));
  });
}
</script>
</body>
</html>
